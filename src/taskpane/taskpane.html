<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Comprehensive Excel Review Tool</title>
    
    <!-- Office.js -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    
    <!-- Fabric UI CSS -->
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/css/fabric.min.css">
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/css/fabric.components.min.css">
</head>

<body class="ms-Fabric">
    <div class="ms-welcome">
        <header class="ms-welcome__header ms-bgColor-neutralLighter">
            <img width="90" height="90" src="../../assets/logo-filled.png" alt="CERT" title="Comprehensive Excel Review Tool" />
            <h1 class="ms-fontSize-su ms-fontWeight-light ms-fontColor-neutralPrimary">Comprehensive Excel Review Tool</h1>
            <h2 class="ms-fontSize-l ms-fontWeight-semilight ms-fontColor-neutralSecondary">Formula Analysis & Review</h2>
        </header>
        
        <main class="ms-welcome__main">
            <!-- Analysis Controls -->
            <section class="ms-welcome__features">
                <div class="ms-Grid">
                    <div class="ms-Grid-row">
                        <div class="ms-Grid-col ms-sm12">
                            <div class="ms-TextField">
                                <label class="ms-Label">Analysis Options</label>
                                <div class="analysis-options">
                                    <div class="checkbox-container">
                                        <input type="checkbox" id="includeEmptyCells" checked>
                                        <label for="includeEmptyCells">Include empty cells in analysis</label>
                                    </div>
                                    <div class="checkbox-container">
                                        <input type="checkbox" id="groupSimilarFormulas" checked>
                                        <label for="groupSimilarFormulas">Group similar formulas</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="ms-Grid">
                    <div class="ms-Grid-row">
                        <div class="ms-Grid-col ms-sm12">
                            <button id="analyzeFormulas" class="ms-Button ms-Button--primary">
                                <span class="ms-Button-label">Analyze Workbook Formulas</span>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Results Section -->
            <section id="resultsSection" class="results-section" style="display: none;">
                <h3 class="ms-fontSize-l ms-fontWeight-semibold">Analysis Results</h3>
                
                <!-- Summary Card -->
                <div id="summaryCard" class="summary-card ms-bgColor-neutralLighter">
                    <div class="ms-Grid">
                        <div class="ms-Grid-row">
                            <div class="ms-Grid-col ms-sm3">
                                <div class="stat-item">
                                    <span class="stat-number" id="totalWorksheets">0</span>
                                    <span class="stat-label">Worksheets</span>
                                </div>
                            </div>
                            <div class="ms-Grid-col ms-sm3">
                                <div class="stat-item">
                                    <span class="stat-number" id="totalFormulas">0</span>
                                    <span class="stat-label">Total Formulas</span>
                                </div>
                            </div>
                            <div class="ms-Grid-col ms-sm3">
                                <div class="stat-item">
                                    <span class="stat-number" id="uniqueFormulas">0</span>
                                    <span class="stat-label">Unique Formulas</span>
                                </div>
                            </div>
                            <div class="ms-Grid-col ms-sm3">
                                <div class="stat-item">
                                    <span class="stat-number" id="totalHardCodedValues">0</span>
                                    <span class="stat-label">Hard-coded Values</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cell Count Analysis -->
                <div id="cellCountAnalysis" class="analysis-section">
                    <h4 class="ms-fontSize-m ms-fontWeight-semibold">Cell Count Analysis</h4>
                    <div class="ms-Grid">
                        <div class="ms-Grid-row">
                            <div class="ms-Grid-col ms-sm3">
                                <div class="stat-item">
                                    <span class="stat-number" id="totalCells">0</span>
                                    <span class="stat-label">Total Cells</span>
                                </div>
                            </div>
                            <div class="ms-Grid-col ms-sm3">
                                <div class="stat-item">
                                    <span class="stat-number" id="cellsWithFormulas">0</span>
                                    <span class="stat-label">Cells with Formulas</span>
                                </div>
                            </div>
                            <div class="ms-Grid-col ms-sm3">
                                <div class="stat-item">
                                    <span class="stat-number" id="cellsWithValues">0</span>
                                    <span class="stat-label">Cells with Values</span>
                                </div>
                            </div>
                            <div class="ms-Grid-col ms-sm3">
                                <div class="stat-item">
                                    <span class="stat-number" id="emptyCells">0</span>
                                    <span class="stat-label">Empty Cells</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Hard-coded Values Analysis -->
                <div id="hardCodedValuesAnalysis" class="analysis-section">
                    <h4 class="ms-fontSize-m ms-fontWeight-semibold">Hard-coded Values Analysis</h4>
                    <div class="ms-Grid">
                        <div class="ms-Grid-row">
                            <div class="ms-Grid-col ms-sm4">
                                <div class="stat-item high-confidence">
                                    <span class="stat-number" id="highConfidenceValues">0</span>
                                    <span class="stat-label">High Confidence</span>
                                </div>
                            </div>
                            <div class="ms-Grid-col ms-sm4">
                                <div class="stat-item medium-confidence">
                                    <span class="stat-number" id="mediumConfidenceValues">0</span>
                                    <span class="stat-label">Medium Confidence</span>
                                </div>
                            </div>
                            <div class="ms-Grid-col ms-sm4">
                                <div class="stat-item low-confidence">
                                    <span class="stat-number" id="lowConfidenceValues">0</span>
                                    <span class="stat-label">Low Confidence</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="hardCodedValuesList" class="hard-coded-values-list">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                </div>

                <!-- Worksheet Details -->
                <div id="worksheetDetails" class="worksheet-details">
                    <!-- Dynamic content will be inserted here -->
                </div>

                <!-- Export Options -->
                <div class="export-options">
                    <button id="exportResults" class="ms-Button">
                        <span class="ms-Button-label">Export Analysis Report</span>
                    </button>
                    <button id="generateAuditTrail" class="ms-Button">
                        <span class="ms-Button-label">Generate Audit Trail</span>
                    </button>
                </div>
            </section>

            <!-- Loading Indicator -->
            <div id="loadingIndicator" class="loading-indicator" style="display: none;">
                <div class="ms-Spinner ms-Spinner--large">
                    <div class="ms-Spinner-circle"></div>
                    <div class="ms-Spinner-label">Analyzing formulas...</div>
                </div>
            </div>

            <!-- Status Messages -->
            <div id="statusMessages" class="status-messages"></div>
        </main>
    </div>
</body>
</html> 
