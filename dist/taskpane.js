/*! For license information please see taskpane.js.LICENSE.txt */
(()=>{var e={56:(e,n,t)=>{"use strict";e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},72:e=>{"use strict";var n=[];function t(e){for(var t=-1,r=0;r<n.length;r++)if(n[r].identifier===e){t=r;break}return t}function r(e,r){for(var a={},i=[],s=0;s<e.length;s++){var l=e[s],c=r.base?l[0]+r.base:l[0],u=a[c]||0,d="".concat(c," ").concat(u);a[c]=u+1;var p=t(d),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)n[p].references++,n[p].updater(f);else{var m=o(f,r);r.byIndex=s,n.splice(s,0,{identifier:d,updater:m,references:1})}i.push(d)}return i}function o(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,o){var a=r(e=e||[],o=o||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var s=t(a[i]);n[s].references--}for(var l=r(e,o),c=0;c<a.length;c++){var u=t(a[c]);0===n[u].references&&(n[u].updater(),n.splice(u,1))}a=l}}},113:e=>{"use strict";e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},314:e=>{"use strict";e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t="",r=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),r&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),r&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t}).join("")},n.i=function(e,t,r,o,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(i[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&i[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),t&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=t):u[2]=t),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),n.push(u))}},n}},519:e=>{e.exports.q=function(e){for(var k=new E,A=new C,S=0,T=function(){return e.substr(S,1)},I=function(){return e.substr(S,2)},F=function(){return e.substr(S+1,1)},R=function(){return S>=e.length},L="",O=!1,N=!1,M=!1,P=!1;e.length>0;){if(" "!=e.substr(0,1)){"="==e.substr(0,1)&&(e=e.substr(1));break}e=e.substr(1)}for(var B=/^[1-9]{1}(\.[0-9]+)?E{1}$/;!R();)if(O)'"'==T()?'"'==F()?(L+='"',S+=1):(O=!1,k.add(L,t,f),L=""):L+=T(),S+=1;else if(N)"'"==T()?"'"==F()?(L+="'",S+=1):N=!1:L+=T(),S+=1;else if(M)"]"==T()&&(M=!1),L+=T(),S+=1;else if(P)L+=T(),S+=1,-1!=",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,".indexOf(","+L+",")&&(P=!1,k.add(L,t,g),L="");else if(-1!="+-".indexOf(T())&&L.length>1&&B.test(L))L+=T(),S+=1;else if('"'!=T())if("'"!=T())if("["!=T())if("#"!=T())if("{"!=T())if(";"!=T())if("}"!=T())if(" "!=T())-1==",>=,<=,<>,".indexOf(","+I()+",")?-1=="+-*/^&=><".indexOf(T())?-1=="%".indexOf(T())?"("!=T()?","!=T()?")"!=T()?(L+=T(),S+=1):(L.length>0&&(k.add(L,t),L=""),k.addRef(A.pop()),S+=1):(L.length>0&&(k.add(L,t),L=""),A.type()!=r?k.add(T(),s,w):k.add(T(),a),S+=1):(L.length>0?(A.push(k.add(L,r,d)),L=""):A.push(k.add("",o,d)),S+=1):(L.length>0&&(k.add(L,t),L=""),k.add(T(),l),S+=1):(L.length>0&&(k.add(L,t),L=""),k.add(T(),s),S+=1):(L.length>0&&(k.add(L,t),L=""),k.add(I(),s,h),S+=2);else for(L.length>0&&(k.add(L,t),L=""),k.add(T(),c),S+=1;" "==T()&&!R();)S+=1;else L.length>0&&(k.add(L,t),L=""),k.addRef(A.pop()),k.addRef(A.pop()),S+=1;else L.length>0&&(k.add(L,t),L=""),k.addRef(A.pop()),k.add(",",a),A.push(k.add("ARRAYROW",r,d)),S+=1;else L.length>0&&(k.add(L,u),L=""),A.push(k.add("ARRAY",r,d)),A.push(k.add("ARRAYROW",r,d)),S+=1;else L.length>0&&(k.add(L,u),L=""),P=!0,L+=T(),S+=1;else M=!0,L+=T(),S+=1;else L.length>0&&(k.add(L,u),L=""),N=!0,S+=1;else L.length>0&&(k.add(L,u),L=""),O=!0,S+=1;L.length>0&&k.add(L,t);for(var D=new E;k.moveNext();)(L=k.current()).type!=c?D.addRef(L):k.BOF()||k.EOF()||(k.previous().type==r&&k.previous().subtype==p||k.previous().type==o&&k.previous().subtype==p||k.previous().type==t)&&(k.next().type==r&&k.next().subtype==d||k.next().type==o&&k.next().subtype==d||k.next().type==t)&&D.add(L.value,s,x);for(;D.moveNext();)(L=D.current()).type!=s||"-"!=L.value?L.type!=s||"+"!=L.value?L.type!=s||0!=L.subtype.length?L.type!=t||0!=L.subtype.length?L.type!=r||"@"==L.value.substr(0,1)&&(L.value=L.value.substr(1)):isNaN(Number(L.value))?"TRUE"==L.value||"FALSE"==L.value?L.subtype=h:L.subtype=y:L.subtype=m:-1!="<>=".indexOf(L.value.substr(0,1))?L.subtype=h:"&"==L.value?L.subtype=v:L.subtype=b:D.BOF()?L.type=n:D.previous().type==r&&D.previous().subtype==p||D.previous().type==o&&D.previous().subtype==p||D.previous().type==l||D.previous().type==t?L.subtype=b:L.type=n:D.BOF()?L.type=i:D.previous().type==r&&D.previous().subtype==p||D.previous().type==o&&D.previous().subtype==p||D.previous().type==l||D.previous().type==t?L.subtype=b:L.type=i;for(D.reset(),k=new E;D.moveNext();)D.current().type!=n&&k.addRef(D.current());return k.reset(),k.toArray()};var n="noop",t="operand",r="function",o="subexpression",a="argument",i="operator-prefix",s="operator-infix",l="operator-postfix",c="white-space",u="unknown",d="start",p="stop",f="text",m="number",h="logical",g="error",y="range",b="math",v="concatenate",x="intersect",w="union";function k(e,n,t=""){return{value:e,type:n,subtype:t}}class E{constructor(){this.items=[],this.index=-1}add(e,n,t){const r=k(e,n,t);return this.addRef(r),r}addRef(e){this.items.push(e)}reset(){this.index=-1}BOF(){return this.index<=0}EOF(){return this.index>=this.items.length-1}moveNext(){return!this.EOF()&&(this.index++,!0)}current(){return-1==this.index?null:this.items[this.index]}next(){return this.EOF()?null:this.items[this.index+1]}previous(){return this.index<1?null:this.items[this.index-1]}toArray(){return this.items}}class C{constructor(){this.items=[]}push(e){this.items.push(e)}pop(){return k("",this.items.pop().type,p)}token(){return this.items.length>0?this.items[this.items.length-1]:null}value(){return this.token()?this.token().value:""}type(){return this.token()?this.token().type:""}subtype(){return this.token()?this.token().subtype:""}}},540:e=>{"use strict";e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},601:e=>{"use strict";e.exports=function(e){return e[1]}},659:e=>{"use strict";var n={};e.exports=function(e,t){var r=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,o&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),n.styleTagTransform(r,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},942:(e,n,t)=>{"use strict";t.d(n,{A:()=>s});var r=t(601),o=t.n(r),a=t(314),i=t.n(a)()(o());i.push([e.id,'body {\n    font-family: \'Arial\', sans-serif;\n}\n\n/* Main container styles */\n.ms-welcome {\n    width: 100%;\n    min-height: 100vh;\n    display: flex;\n    flex-direction: column;\n}\n\n.ms-welcome__header {\n    width: 100%;\n    padding: 24px 20px;\n    border-bottom: 1px solid #e1dfdd;\n    background: linear-gradient(135deg, #faf9f8 0%, #f3f2f1 100%);\n    color: #323130;\n}\n\n.branding {\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    max-width: 100%;\n}\n\n.brand-logo {\n    height: 48px;\n    object-fit: contain;\n}\n\n.brand-text h1 {\n    margin: 0;\n    font-size: 24px;\n    font-weight: 600;\n    color: #164c8c;\n}\n\n.brand-text p {\n    margin: 2px 0 0 0;\n    font-size: 14px;\n    letter-spacing: 0.5px;\n    color: #605e5c;\n}\n\n.ms-welcome__main {\n    flex-grow: 1;\n    padding: 20px;\n    background: #f3f2f1;\n}\n\n/* Analysis options styling */\n.analysis-options {\n    margin: 12px 0;\n    padding: 16px;\n    background: #ffffff;\n    border: 1px solid #e1dfdd;\n    border-radius: 6px;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n}\n\n.checkbox-container {\n    margin: 10px 0;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.checkbox-container input[type="checkbox"] {\n    width: 16px;\n    height: 16px;\n    cursor: pointer;\n    accent-color: #0078d4;\n}\n\n.checkbox-container label {\n    cursor: pointer;\n    font-size: 14px;\n    color: #201f1e;\n    font-weight: 500;\n    letter-spacing: 0.2px;\n    user-select: none;\n}\n\n.ms-Label {\n    font-weight: 600;\n    color: #201f1e;\n}\n\n/* Button styling */\nbutton#analyzeFormulas,\nbutton#generateMaps,\nbutton#refreshMapSheets {\n    width: 100%;\n    margin: 12px 0;\n    padding: 12px;\n}\n\n.map-controls {\n    margin-top: 12px;\n    padding: 16px;\n    border: 1px solid #e1dfdd;\n    border-radius: 6px;\n    background: #ffffff;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n}\n\n.map-actions {\n    display: flex;\n    gap: 8px;\n}\n\n.map-actions .ms-Button {\n    flex: 1;\n}\n\n.map-refresh-button {\n    background: #edebe9;\n    color: #323130;\n}\n\n.map-selection {\n    display: flex;\n    flex-direction: column;\n}\n\n.map-selection-actions {\n    display: flex;\n    gap: 6px;\n    margin-bottom: 8px;\n}\n\n.map-mini-button {\n    flex: 1;\n    padding: 6px 8px;\n    font-size: 12px;\n    background: #f3f2f1;\n    color: #323130;\n}\n\n.map-mini-button .ms-Button-label {\n    font-size: 12px;\n}\n\n.map-selection-label {\n    font-weight: 600;\n    margin-bottom: 6px;\n    color: #201f1e;\n}\n\n.map-sheet-list {\n    max-height: 180px;\n    overflow-y: auto;\n    border: 1px solid #e1dfdd;\n    border-radius: 4px;\n    padding: 8px;\n    background: #faf9f8;\n}\n\n.map-sheet-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 4px 0;\n    font-size: 13px;\n}\n\n.map-sheet-item input[type="checkbox"] {\n    width: 16px;\n    height: 16px;\n    accent-color: #0078d4;\n}\n\n.map-sheet-placeholder {\n    font-size: 12px;\n    color: #605e5c;\n    font-style: italic;\n    padding: 6px;\n}\n\n.map-run-summary {\n    font-size: 12px;\n    color: #605e5c;\n}\n\n.map-run-summary strong {\n    color: #323130;\n}\n\n.map-summary-list {\n    margin: 6px 0 0 0;\n    padding-left: 18px;\n    color: #605e5c;\n}\n\n.map-summary-list li {\n    margin: 2px 0;\n}\n\n.map-legend {\n    border-top: 1px solid #edebe9;\n    padding-top: 12px;\n}\n\n.map-legend h5 {\n    margin: 0 0 8px 0;\n    font-size: 13px;\n    color: #201f1e;\n}\n\n.map-legend ul {\n    margin: 0;\n    padding-left: 16px;\n    list-style: none;\n}\n\n.map-legend li {\n    font-size: 12px;\n    color: #605e5c;\n    margin: 4px 0;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.map-symbol {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    width: 22px;\n    height: 22px;\n    border-radius: 4px;\n    font-weight: 600;\n    font-size: 12px;\n    color: #ffffff;\n}\n\n.map-symbol-f { background: #7030A0; }\n.map-symbol-left { background: #4472C4; }\n.map-symbol-up { background: #5B9BD5; }\n.map-symbol-both { background: #2F5597; }\n.map-symbol-label { background: #7F7F7F; }\n.map-symbol-input { background: #FFC000; color: #1b1a19; }\n.map-symbol-array { background: #9E480E; }\n\n.map-legend-note {\n    font-size: 11px;\n    color: #8a8886;\n    margin-top: 8px;\n}\n\n.map-legend ul li .map-symbol-input {\n    color: #1b1a19;\n}\n\n/* Results section */\n.results-section {\n    margin-top: 30px;\n    border-top: 1px solid #edebe9;\n    padding-top: 20px;\n    animation: fadeIn 0.3s ease-in-out;\n}\n\n/* Summary card */\n.summary-card {\n    padding: 20px;\n    margin: 20px 0;\n    border-radius: 4px;\n    border: 1px solid #d2d0ce;\n}\n\n/* Analysis sections */\n.analysis-section {\n    margin: 20px 0;\n    padding: 15px;\n    background: #faf9f8;\n    border: 1px solid #e1dfdd;\n    border-radius: 4px;\n}\n\n.analysis-section h4 {\n    margin: 0 0 15px 0;\n    color: #323130;\n    border-bottom: 1px solid #e1dfdd;\n    padding-bottom: 8px;\n}\n\n/* Section titles and help text */\n.section-title {\n    margin: 10px 0 6px 0;\n    color: #201f1e;\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.section-help {\n    margin: 6px 0 14px 0;\n    color: #605e5c;\n    font-size: 12px;\n    line-height: 1.5;\n}\n\n.stat-item {\n    text-align: center;\n    padding: 10px;\n}\n\n.stat-number {\n    display: block;\n    font-size: 28px;\n    font-weight: 600;\n    color: #0078d4;\n    line-height: 1.2;\n}\n\n.stat-label {\n    display: block;\n    font-size: 12px;\n    color: #605e5c;\n    margin-top: 5px;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n/* Worksheet details */\n.worksheet-details {\n    margin: 20px 0;\n}\n\n.worksheet-card {\n    background: #ffffff;\n    border: 1px solid #e1dfdd;\n    border-radius: 6px;\n    margin: 10px 0;\n    padding: 16px;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);\n}\n\n.worksheet-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 10px;\n}\n\n.worksheet-name {\n    font-weight: 600;\n    color: #323130;\n    font-size: 16px;\n}\n\n.worksheet-mode {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.mode-pill {\n    padding: 4px 8px;\n    border-radius: 999px;\n    background: #eff6fb;\n    color: #004578;\n    font-size: 11px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.4px;\n}\n\n.fallback-note {\n    font-size: 11px;\n    color: #a4262c;\n    font-weight: 500;\n}\n\n.worksheet-stats {\n    display: flex;\n    gap: 20px;\n    margin: 10px 0;\n}\n\n.worksheet-stat {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.worksheet-stat-number {\n    font-size: 18px;\n    font-weight: 600;\n    color: #0078d4;\n}\n\n.worksheet-stat-label {\n    font-size: 11px;\n    color: #605e5c;\n    text-transform: uppercase;\n}\n\n/* Hard-coded values confidence styling */\n.high-confidence .stat-number {\n    color: #d13438;\n}\n\n.medium-confidence .stat-number {\n    color: #ff8c00;\n}\n\n.low-confidence .stat-number {\n    color: #605e5c;\n}\n\n/* Hard-coded values list */\n.hard-coded-values-list {\n    margin-top: 15px;\n    max-height: 300px;\n    overflow-y: auto;\n}\n\n.hard-coded-value-item {\n    background: white;\n    border: 1px solid #e1dfdd;\n    border-radius: 2px;\n    padding: 10px;\n    margin: 5px 0;\n    font-size: 12px;\n}\n\n.hard-coded-value-item.high-confidence {\n    border-left: 4px solid #d13438;\n}\n\n.hard-coded-value-item.medium-confidence {\n    border-left: 4px solid #ff8c00;\n}\n\n.hard-coded-value-item.low-confidence {\n    border-left: 4px solid #605e5c;\n}\n\n.hard-coded-value-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 5px;\n}\n\n.hard-coded-value-address {\n    font-weight: 600;\n    color: #0078d4;\n}\n\n.hard-coded-value-confidence {\n    padding: 2px 6px;\n    border-radius: 3px;\n    font-size: 10px;\n    text-transform: uppercase;\n    font-weight: 600;\n}\n\n.hard-coded-value-confidence.high {\n    background-color: #fde7e9;\n    color: #d13438;\n}\n\n.hard-coded-value-confidence.medium {\n    background-color: #fff4ce;\n    color: #ff8c00;\n}\n\n.hard-coded-value-confidence.low {\n    background-color: #f3f2f1;\n    color: #605e5c;\n}\n\n.hard-coded-value-content {\n    font-family: \'Consolas\', \'Monaco\', monospace;\n    color: #323130;\n    word-break: break-all;\n    margin: 5px 0;\n}\n\n.hard-coded-value-reason {\n    color: #605e5c;\n    font-size: 11px;\n    font-style: italic;\n}\n\n/* Inconsistency badge styling */\n.inconsistency-badge {\n    display: inline-block;\n    padding: 2px 6px;\n    font-size: 10px;\n    font-weight: 600;\n    border-radius: 3px;\n    text-transform: uppercase;\n    margin-left: 8px;\n}\n\n.inconsistency-badge.value_mismatch {\n    background-color: #ff6b6b;\n    color: white;\n}\n\n.inconsistency-badge.range_endpoint {\n    background-color: #ff9f43;\n    color: white;\n}\n\n.inconsistency-badge.pattern_deviation {\n    background-color: #4ecdc4;\n    color: white;\n}\n\n.inconsistency-badge.isolated_hardcode {\n    background-color: #95a5a6;\n    color: white;\n}\n\n/* Nearby patterns styling */\n.nearby-patterns {\n    margin-top: 8px;\n    padding: 8px;\n    background-color: #f8f9fa;\n    border-radius: 4px;\n    font-size: 11px;\n}\n\n.nearby-patterns ul {\n    margin: 4px 0 0 0;\n    padding-left: 20px;\n}\n\n.nearby-patterns li {\n    margin: 2px 0;\n    font-family: \'Courier New\', monospace;\n    font-size: 10px;\n    color: #495057;\n}\n\n/* Formula list */\n.formula-list {\n    margin-top: 15px;\n}\n\n.formula-item {\n    background: white;\n    border: 1px solid #e1dfdd;\n    border-radius: 2px;\n    padding: 10px;\n    margin: 5px 0;\n    font-family: \'Consolas\', \'Monaco\', monospace;\n    font-size: 12px;\n}\n\n.formula-text {\n    color: #0078d4;\n    word-break: break-all;\n}\n\n.formula-count {\n    color: #605e5c;\n    font-size: 11px;\n    margin-top: 5px;\n}\n\n/* Export options */\n.export-options {\n    margin: 30px 0;\n    display: flex;\n    gap: 10px;\n    flex-wrap: wrap;\n}\n\n.export-options button {\n    flex: 1;\n    min-width: 150px;\n}\n\n/* Loading indicator */\n.loading-indicator {\n    text-align: center;\n    padding: 40px;\n}\n\n/* Status messages */\n.status-messages {\n    margin: 20px 0;\n}\n\n.status-message {\n    padding: 10px;\n    margin: 10px 0;\n    border-radius: 4px;\n    border-left: 4px solid;\n}\n\n.status-success {\n    background-color: #dff6dd;\n    border-color: #107c10;\n    color: #107c10;\n}\n\n.status-error {\n    background-color: #fde7e9;\n    border-color: #d13438;\n    color: #d13438;\n}\n\n.status-warning {\n    background-color: #fff4ce;\n    border-color: #ff8c00;\n    color: #ff8c00;\n}\n\n.status-info {\n    background-color: #deecf9;\n    border-color: #0078d4;\n    color: #0078d4;\n}\n\n/* Responsive design */\n@media (max-width: 480px) {\n    .ms-welcome__header {\n        padding: 15px;\n    }\n    \n    .ms-welcome__main {\n        padding: 15px;\n    }\n    \n    .worksheet-stats {\n        flex-direction: column;\n        gap: 10px;\n    }\n    \n    .export-options {\n        flex-direction: column;\n    }\n    \n    .export-options button {\n        width: 100%;\n    }\n}\n\n/* Accessibility improvements */\n.ms-Button:focus,\n.ms-CheckBox-field:focus {\n    outline: 2px solid #0078d4;\n    outline-offset: 2px;\n}\n\n/* Animation for loading */\n@keyframes fadeIn {\n    from { opacity: 0; transform: translateY(10px); }\n    to { opacity: 1; transform: translateY(0); }\n} \n\n.analysis-shell {\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n}\n\n.analysis-tabs {\n    display: flex;\n    gap: 8px;\n    border-bottom: 1px solid #edebe9;\n    padding-bottom: 4px;\n}\n\n.analysis-tab {\n    background: transparent;\n    border: none;\n    padding: 8px 16px;\n    font-size: 14px;\n    font-weight: 600;\n    color: #605e5c;\n    border-radius: 4px 4px 0 0;\n    cursor: pointer;\n}\n\n.analysis-tab[aria-selected="true"] {\n    color: #0078d4;\n    border-bottom: 3px solid #0078d4;\n}\n\n.analysis-view {\n    background: #ffffff;\n    border: 1px solid #edebe9;\n    border-radius: 6px;\n    padding: 16px;\n}\n\n.analysis-toolbar {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 16px;\n    align-items: center;\n    padding: 8px 12px;\n    background: #faf9f8;\n    border: 1px solid #edebe9;\n    border-radius: 6px;\n}\n\n.toolbar-section {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.toolbar-section[hidden] {\n    display: none !important;\n}\n\n.toolbar-section label {\n    font-weight: 600;\n}\n\n.toolbar-section input[type="number"],\n.toolbar-section select,\n.toolbar-section input[type="search"] {\n    padding: 6px 8px;\n    border: 1px solid #c8c6c4;\n    border-radius: 4px;\n    font-size: 13px;\n}\n\n.toolbar-button {\n    padding: 6px 12px;\n}\n\n.toolbar-checkbox {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    font-size: 13px;\n}\n\n.toolbar-note {\n    font-size: 11px;\n    color: #8a8886;\n}\n\n.summary-overview {\n    margin-top: 16px;\n}\n\n.summary-budget-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));\n    gap: 12px;\n}\n\n.summary-budget-card {\n    background: #f8f8f8;\n    border: 1px solid #e1dfdd;\n    border-radius: 4px;\n    padding: 12px;\n    text-align: center;\n}\n\n.summary-budget-number {\n    display: block;\n    font-size: 24px;\n    font-weight: 700;\n    color: #0078d4;\n}\n\n.summary-budget-label {\n    display: block;\n    margin-top: 4px;\n    font-size: 12px;\n    color: #605e5c;\n    text-transform: uppercase;\n    letter-spacing: 0.6px;\n}\n\n/* Workbook stats section */\n.workbook-stats-section {\n    margin-top: 24px;\n    padding-top: 24px;\n    border-top: 1px solid #edebe9;\n}\n\n.workbook-stats-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 8px;\n}\n\n.ask-gpt-workbook-button {\n    flex-shrink: 0;\n}\n\n.ask-gpt-cell {\n    text-align: center;\n    padding: 8px 12px;\n}\n\n.stats-grid {\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n    margin-top: 16px;\n}\n\n.stats-group {\n    background: #faf9f8;\n    border: 1px solid #e1dfdd;\n    border-radius: 4px;\n    padding: 16px;\n}\n\n\n.stats-grid-inner {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));\n    gap: 12px;\n}\n\n.stat-card {\n    background: #ffffff;\n    border: 1px solid #e1dfdd;\n    border-radius: 4px;\n    padding: 12px;\n    text-align: center;\n    transition: box-shadow 0.2s ease;\n}\n\n.stat-card:hover {\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.stat-card-high .stat-number {\n    color: #d13438;\n}\n\n.stat-card-medium .stat-number {\n    color: #ff8c00;\n}\n\n.stat-card-low .stat-number {\n    color: #ffaa44;\n}\n\n.stat-number {\n    display: block;\n    font-size: 22px;\n    font-weight: 700;\n    color: #0078d4;\n    line-height: 1.2;\n}\n\n.stat-label {\n    display: block;\n    margin-top: 4px;\n    font-size: 11px;\n    color: #605e5c;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n/* Help icon and tooltips */\n.help-icon {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    width: 18px;\n    height: 18px;\n    border-radius: 50%;\n    background: #0078d4;\n    color: #ffffff;\n    font-size: 12px;\n    font-weight: 600;\n    cursor: help;\n    position: relative;\n    flex-shrink: 0;\n    line-height: 1;\n}\n\n.help-icon:hover {\n    background: #005a9e;\n}\n\n.help-icon-inline {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    width: 14px;\n    height: 14px;\n    border-radius: 50%;\n    background: #605e5c;\n    color: #ffffff;\n    font-size: 10px;\n    font-weight: 600;\n    cursor: help;\n    position: relative;\n    margin-left: 4px;\n    vertical-align: middle;\n    line-height: 1;\n}\n\n.help-icon-inline:hover {\n    background: #323130;\n}\n\n.help-icon[data-tooltip]:hover::after,\n.help-icon-inline[data-tooltip]:hover::after {\n    content: attr(data-tooltip);\n    position: absolute;\n    top: 100%;\n    left: 50%;\n    transform: translateX(-50%);\n    margin-top: 6px;\n    padding: 8px 12px;\n    background: #323130;\n    color: #ffffff;\n    font-size: 12px;\n    font-weight: normal;\n    white-space: normal;\n    width: max-content;\n    min-width: 200px;\n    max-width: min(300px, calc(100vw - 40px));\n    border-radius: 4px;\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n    z-index: 10000;\n    pointer-events: none;\n    line-height: 1.4;\n    text-align: left;\n    text-transform: none;\n    letter-spacing: normal;\n    word-wrap: break-word;\n}\n\n.help-icon-inline[data-tooltip]:hover::after {\n    left: 50%;\n    transform: translateX(-50%);\n    width: 200px;\n}\n\n.help-icon[data-tooltip]:hover::before,\n.help-icon-inline[data-tooltip]:hover::before {\n    content: \'\';\n    position: absolute;\n    bottom: 100%;\n    top: auto;\n    left: 50%;\n    transform: translateX(-50%);\n    margin-bottom: 0;\n    margin-top: 0;\n    border: 6px solid transparent;\n    border-bottom-color: #323130;\n    border-top-color: transparent;\n    z-index: 10001;\n    pointer-events: none;\n}\n\n.help-icon-inline[data-tooltip]:hover::before {\n    left: 50%;\n    transform: translateX(-50%);\n}\n\n.stats-group-title {\n    margin: 0 0 12px 0;\n    font-size: 14px;\n    font-weight: 600;\n    color: #323130;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n}\n\n.stat-label {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-top: 4px;\n    font-size: 11px;\n    color: #605e5c;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    flex-wrap: wrap;\n    gap: 4px;\n}\n\n/* Sheet breakdown section */\n.sheet-breakdown-section {\n    margin-top: 32px;\n    padding-top: 32px;\n    border-top: 2px solid #0078d4;\n    background: #faf9f8;\n    padding: 24px;\n    border-radius: 6px;\n    margin-left: -8px;\n    margin-right: -8px;\n}\n\n.sheet-breakdown-content {\n    margin-top: 16px;\n    overflow-x: auto;\n}\n\n.sheet-breakdown-table {\n    width: 100%;\n    border-collapse: collapse;\n    font-size: 12px;\n    background: #ffffff;\n    border: 1px solid #e1dfdd;\n    border-radius: 4px;\n    overflow: hidden;\n}\n\n.sheet-breakdown-table thead {\n    background: #f3f2f1;\n}\n\n.sheet-breakdown-table th {\n    padding: 10px 12px;\n    text-align: left;\n    font-weight: 600;\n    color: #323130;\n    font-size: 11px;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    border-bottom: 2px solid #e1dfdd;\n}\n\n.sheet-breakdown-table td {\n    padding: 10px 12px;\n    border-bottom: 1px solid #edebe9;\n    color: #323130;\n}\n\n.sheet-breakdown-table tbody tr:hover {\n    background: #faf9f8;\n}\n\n.sheet-breakdown-table tbody tr:last-child td {\n    border-bottom: none;\n}\n\n.sheet-name-cell {\n    font-weight: 600;\n    color: #0078d4;\n}\n\n.number-cell {\n    text-align: right;\n    font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n    color: #323130;\n}\n\n.complexity-cell {\n    font-weight: 600;\n    text-align: center;\n}\n\n.complexity-fscore-cell {\n    text-align: center;\n    vertical-align: middle;\n    padding: 4px 8px;\n}\n\n.complexity-label {\n    font-weight: 600;\n    margin-bottom: 2px;\n}\n\n.complexity-high {\n    color: #d13438;\n}\n\n.complexity-medium {\n    color: #ff8c00;\n}\n\n.complexity-low {\n    color: #107c10;\n}\n\n.fscore-label {\n    font-size: 11px;\n    color: #605e5c;\n    margin-top: 2px;\n}\n\n\n.listing-table-shell {\n    border: 1px solid #edebe9;\n    border-radius: 6px;\n    background: #ffffff;\n}\n\n.listing-scroll {\n    max-height: 600px;\n    min-height: 500px;\n    overflow: auto;\n}\n\n#uniqueFormulaTable {\n    width: 100%;\n    border-collapse: collapse;\n    font-size: 12px;\n    table-layout: fixed;\n}\n\n#uniqueFormulaTable thead {\n    position: sticky;\n    top: 0;\n    background: #f3f2f1;\n    z-index: 1;\n}\n\n#uniqueFormulaTable th,\n#uniqueFormulaTable td {\n    padding: 8px;\n    border: 1px solid #edebe9;\n    text-align: left;\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    white-space: normal;\n}\n\n#uniqueFormulaTable td[contenteditable="true"] {\n    background: #fdfdfd;\n    min-width: 120px;\n}\n\n.formula-cell {\n    font-family: \'Consolas\', \'Monaco\', monospace;\n    color: #0078d4;\n    white-space: normal;\n    word-break: break-word;\n}\n\n.clickable-formula {\n    cursor: pointer;\n    text-decoration: underline;\n}\n\n.clickable-formula:hover {\n    color: #005a9e;\n    background-color: #f3f2f1;\n}\n\n.fin-subrow {\n    background-color: #faf9f8;\n}\n\n.fin-subrow td {\n    padding-left: 32px;\n    font-size: 11px;\n    color: #605e5c;\n}\n\n.fin-subrow .fin-cell {\n    font-weight: 600;\n    color: #0078d4;\n}\n\n/* Grey out only Priority and Status columns in UFI rows when no FIN exists */\n.ufi-priority-status-greyed {\n    opacity: 0.5;\n    background-color: #f3f2f1;\n    color: #8a8886;\n    pointer-events: none;\n}\n\n.ufi-priority-status-greyed select {\n    background-color: #f3f2f1 !important;\n    color: #8a8886 !important;\n    cursor: not-allowed;\n}\n\n.ufi-priority-status-greyed[contenteditable="true"] {\n    cursor: not-allowed;\n}\n\n/* Sheet header row styling - subtle and professional */\n.sheet-header-row {\n    background-color: #faf9f8;\n}\n\n.sheet-header-cell {\n    background-color: #faf9f8 !important;\n    color: #323130 !important;\n    font-weight: 600 !important;\n    font-size: 12px !important;\n    padding: 10px 8px !important;\n    border-top: 1px solid #edebe9 !important;\n    border-bottom: 1px solid #edebe9 !important;\n    border-left: none !important;\n    border-right: none !important;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.sheet-separator-row {\n    height: 2px;\n}\n\n.sheet-separator-cell {\n    padding: 0 !important;\n    height: 2px;\n    background-color: #edebe9 !important;\n    border-top: 1px solid #edebe9 !important;\n    border-bottom: none !important;\n}\n\n.add-fin-button {\n    background-color: #0078d4;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    width: 24px;\n    height: 24px;\n    cursor: pointer;\n    font-size: 16px;\n    font-weight: bold;\n    margin-right: 8px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0;\n}\n\n.add-fin-button:hover {\n    background-color: #005a9e;\n}\n\n.add-fin-button:active {\n    background-color: #004578;\n}\n\n.ask-gpt-button {\n    background-color: #ffffff;\n    color: #0078d4;\n    border: 1px solid #0078d4;\n    border-radius: 4px;\n    padding: 4px 12px;\n    cursor: not-allowed;\n    font-size: 12px;\n    opacity: 0.6;\n}\n\n.delete-fin-button {\n    background-color: #d13438;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    width: 20px;\n    height: 20px;\n    cursor: pointer;\n    font-size: 16px;\n    font-weight: bold;\n    margin-left: 8px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0;\n    line-height: 1;\n}\n\n.delete-fin-button:hover {\n    background-color: #a4262c;\n}\n\n.priority-dropdown {\n    width: 100%;\n    padding: 4px 8px;\n    border: 1px solid #c8c6c4;\n    border-radius: 4px;\n    font-size: 12px;\n    cursor: pointer;\n}\n\n.priority-dropdown {\n    transition: background-color 0.2s;\n}\n\n.priority-dropdown:has(option[value="High"]:checked),\n.priority-dropdown option[value="High"] {\n    background-color: #d13438;\n    color: white;\n}\n\n.priority-dropdown:has(option[value="Medium"]:checked),\n.priority-dropdown option[value="Medium"] {\n    background-color: #ffaa44;\n    color: white;\n}\n\n.priority-dropdown:has(option[value="Low"]:checked),\n.priority-dropdown option[value="Low"] {\n    background-color: #107c10;\n    color: white;\n}\n\n/* Apply background color based on selected value */\n.priority-dropdown[data-selected="High"] {\n    background-color: #d13438;\n    color: white;\n}\n\n.priority-dropdown[data-selected="Medium"] {\n    background-color: #ffaa44;\n    color: white;\n}\n\n.priority-dropdown[data-selected="Low"] {\n    background-color: #107c10;\n    color: white;\n}\n\n.priority-dropdown option {\n    background-color: white;\n    color: #323130;\n}\n\n.sortable-header {\n    cursor: pointer;\n    user-select: none;\n    position: relative;\n}\n\n.sortable-header:hover {\n    background-color: #edebe9;\n}\n\n.sortable-header::after {\n    content: \'\';\n    position: absolute;\n    right: 4px;\n    top: 50%;\n    transform: translateY(-50%);\n}\n\n.sortable-header.sort-asc::after {\n    content: \' ↑\';\n}\n\n.sortable-header.sort-desc::after {\n    content: \' ↓\';\n}\n\n#uniqueFormulaTable th {\n    position: relative;\n    min-width: 60px;\n}\n\n#uniqueFormulaTable th.sortable-header {\n    cursor: pointer;\n    user-select: none;\n}\n\n.column-resize-handle {\n    position: absolute;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    width: 4px;\n    cursor: col-resize;\n    z-index: 10;\n    background: transparent;\n}\n\n.column-resize-handle:hover {\n    background: #0078d4;\n    opacity: 0.5;\n}\n\n/* GPT Settings Modal */\n.modal-overlay {\n    display: none;\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5);\n    z-index: 1000;\n    justify-content: center;\n    align-items: center;\n}\n\n.modal-content {\n    background: white;\n    border-radius: 8px;\n    padding: 0;\n    max-width: 500px;\n    width: 90%;\n    max-height: 90vh;\n    overflow: auto;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n}\n\n.modal-content.modal-large {\n    max-width: 700px;\n}\n\n.modal-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 20px;\n    border-bottom: 1px solid #edebe9;\n}\n\n.modal-header h3 {\n    margin: 0;\n    font-size: 20px;\n    font-weight: 600;\n}\n\n.modal-close {\n    background: none;\n    border: none;\n    font-size: 28px;\n    cursor: pointer;\n    color: #605e5c;\n    padding: 0;\n    width: 32px;\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.modal-close:hover {\n    color: #323130;\n    background-color: #f3f2f1;\n    border-radius: 4px;\n}\n\n.modal-body {\n    padding: 20px;\n}\n\n.modal-footer {\n    padding: 20px;\n    border-top: 1px solid #edebe9;\n    display: flex;\n    gap: 10px;\n    justify-content: flex-end;\n}\n\n.form-field {\n    margin-bottom: 16px;\n}\n\n.form-field label {\n    display: block;\n    margin-bottom: 8px;\n    font-weight: 600;\n    color: #323130;\n}\n\n.form-field input {\n    width: 100%;\n    padding: 8px 12px;\n    border: 1px solid #c8c6c4;\n    border-radius: 4px;\n    font-size: 14px;\n    box-sizing: border-box;\n}\n\n.form-field input:focus {\n    outline: none;\n    border-color: #0078d4;\n    box-shadow: 0 0 0 1px #0078d4;\n}\n\n.settings-status {\n    padding: 12px;\n    border-radius: 4px;\n    margin-top: 12px;\n    font-size: 14px;\n}\n\n.settings-status.info {\n    background-color: #deecf9;\n    color: #004578;\n}\n\n.settings-status.success {\n    background-color: #dff6dd;\n    color: #107c10;\n}\n\n.settings-status.error {\n    background-color: #fed9cc;\n    color: #a4262c;\n}\n\n.gpt-response-content {\n    padding: 16px;\n    background-color: #faf9f8;\n    border-radius: 4px;\n    word-wrap: break-word;\n    line-height: 1.6;\n    font-size: 14px;\n    color: #323130;\n}\n\n.gpt-response-content strong {\n    font-weight: 600;\n    color: #323130;\n}\n\n.gpt-response-content em {\n    font-style: italic;\n}\n\n.gpt-response-content h1,\n.gpt-response-content h2,\n.gpt-response-content h3 {\n    margin: 16px 0 8px 0;\n    font-weight: 600;\n    color: #323130;\n}\n\n.gpt-response-content h1 {\n    font-size: 18px;\n}\n\n.gpt-response-content h2 {\n    font-size: 16px;\n}\n\n.gpt-response-content h3 {\n    font-size: 14px;\n}\n\n.gpt-response-content ul {\n    margin: 8px 0;\n    padding-left: 24px;\n}\n\n.gpt-response-content li {\n    margin: 4px 0;\n}\n\n.gpt-response-content code {\n    background: #f3f2f1;\n    padding: 2px 6px;\n    border-radius: 3px;\n    font-family: \'Consolas\', \'Monaco\', monospace;\n    font-size: 12px;\n}\n\n.gpt-response-content p {\n    margin: 8px 0;\n}\n\n.gpt-response-error {\n    padding: 16px;\n    background-color: #fed9cc;\n    border-radius: 4px;\n    color: #a4262c;\n    font-size: 14px;\n}\n\n.listing-empty {\n    text-align: center;\n    color: #605e5c;\n    font-style: italic;\n}\n\n.sheet-scope-picker {\n    max-height: 220px;\n    overflow: auto;\n    border: 1px solid #edebe9;\n    border-radius: 4px;\n    background: #ffffff;\n    padding: 8px;\n}\n\n.sheet-scope-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 4px 0;\n}\n\n.sheet-scope-placeholder {\n    font-size: 12px;\n    color: #605e5c;\n    font-style: italic;\n}\n\n.color-controls {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n}\n\n.color-actions {\n    display: flex;\n    gap: 10px;\n}\n\n.color-options {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n}\n\n@media (max-width: 768px) {\n    .analysis-toolbar {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n\n    .analysis-tab {\n        flex: 1 1 auto;\n        text-align: center;\n    }\n\n    .color-actions {\n        flex-direction: column;\n    }\n} ',""]);const s=i}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={id:r,exports:{}};return e[r](a,a.exports,t),a.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0,(()=>{"use strict";var e=t(72),n=t.n(e),r=t(825),o=t.n(r),a=t(659),i=t.n(a),s=t(56),l=t.n(s),c=t(540),u=t.n(c),d=t(113),p=t.n(d),f=t(942),m={};function h(e,n){return"".concat(function(e){for(var n="",t=e;t>0;){var r=(t-1)%26;n=String.fromCharCode(65+r)+n,t=Math.floor((t-1)/26)}return n}(n+1)).concat(e+1)}function g(e){return"string"==typeof e&&e.startsWith("=")}function y(e){return null==e||""===e}function b(e){var n=e;return(n=(n=(n=n.replace(/\$[A-Z]+\$\d+/g,"<ABS>")).replace(/\$?[A-Z]+\$?\d+/g,"<REL>")).replace(/<REL>:<REL>/g,"<RANGE>")).replace(/<ABS>:<ABS>/g,"<ABS_RANGE>")}function v(e){return Math.round(100*e)/100}m.styleTagTransform=p(),m.setAttributes=l(),m.insert=i().bind(null,"head"),m.domAPI=o(),m.insertStyleElement=u(),n()(f.A,m),f.A&&f.A.locals&&f.A.locals;var x=t(519),w=new Set(["DATE","DATEVALUE","EDATE","EOMONTH","TODAY","NOW","WORKDAY","WORKDAY.INTL","WEEKDAY","WEEKNUM","YEAR","MONTH","DAY"]),k=new Set(["TIME","TIMEVALUE","HOUR","MINUTE","SECOND"]),E=new Set(["Y","N","A","B","X"]),C=new Set(["PI","E","PHI","TRUE","FALSE"]),A=/^0x[0-9a-f]+$/i,S=/^([01]?\d|2[0-3]):[0-5]\d(?::[0-5]\d(?:\.\d{1,3})?)?$/,T=/^(\d{1,2}[/-]){2}\d{2,4}$/;var I={SUM:1,AVERAGE:1,MIN:1,MAX:1,COUNT:1,COUNTA:1,COUNTIF:2,COUNTIFS:2,SUMIF:2,SUMIFS:2,AVERAGEIF:2,AVERAGEIFS:2,SUMPRODUCT:2,PRODUCT:1,QUOTIENT:1,ROUND:1,ROUNDUP:1,ROUNDDOWN:1,MROUND:1,CEILING:1,"CEILING.MATH":1,FLOOR:1,"FLOOR.MATH":1,TRUNC:1,INT:1,MOD:1,ABS:1,SIGN:1,SQRT:1,POWER:1,EXP:1,LN:1,LOG:1,LOG10:1,FACT:1,COMBIN:1,PERMUT:1,LEFT:1,RIGHT:1,MID:1,LEN:1,UPPER:1,LOWER:1,PROPER:1,TRIM:1,CLEAN:1,SUBSTITUTE:2,REPLACE:2,FIND:2,SEARCH:2,TEXT:1,CONCAT:1,CONCATENATE:1,TEXTJOIN:2,VALUE:1,NUMBERVALUE:1,T:1,EXACT:1,REPT:1,IF:2,IFS:2,SWITCH:2,AND:1,OR:1,NOT:1,XOR:1,IFERROR:2,IFNA:2,DATE:1,DATEVALUE:1,EDATE:2,EOMONTH:2,WORKDAY:2,"WORKDAY.INTL":2,NETWORKDAYS:2,"NETWORKDAYS.INTL":2,TODAY:3,NOW:3,YEAR:1,MONTH:1,DAY:1,WEEKDAY:1,WEEKNUM:1,YEARFRAC:2,DATEDIF:2,TIME:1,TIMEVALUE:1,HOUR:1,MINUTE:1,SECOND:1,DAYS:1,DAYS360:1,MATCH:2,XMATCH:2,INDEX:3,XLOOKUP:3,VLOOKUP:3,HLOOKUP:3,LOOKUP:3,CHOOSE:2,GETPIVOTDATA:3,FILTER:3,UNIQUE:3,SORT:3,SORTBY:3,SEQUENCE:3,TAKE:3,DROP:3,RANDARRAY:3,TOCOL:3,TOROW:3,WRAPCOLS:3,WRAPROWS:3,EXPAND:3,HSTACK:3,VSTACK:3,PMT:2,FV:2,PV:2,NPV:2,IRR:2,MIRR:2,RATE:2,NPER:2,IPMT:2,PPMT:2,CUMIPMT:2,CUMPRINC:2,DB:2,DDB:2,SLN:2,SYD:2,VDB:2,STDEV:2,STDEVP:2,"STDEV.S":2,"STDEV.P":2,VAR:2,VARP:2,"VAR.S":2,"VAR.P":2,CORREL:2,COVAR:2,PEARSON:2,RSQ:2,FORECAST:3,"FORECAST.LINEAR":3,TREND:3,GROWTH:3,LINEST:3,LOGEST:3,PERCENTILE:2,"PERCENTILE.INC":2,"PERCENTILE.EXC":2,QUARTILE:2,"QUARTILE.INC":2,"QUARTILE.EXC":2,RANK:2,"RANK.AVG":2,"RANK.EQ":2,PERCENTRANK:2,"PERCENTRANK.INC":2,"PERCENTRANK.EXC":2,MEDIAN:2,MODE:2,"MODE.SNGL":2,"MODE.MULT":2,LARGE:2,SMALL:2,FREQUENCY:2,LET:2,LAMBDA:3,REDUCE:3,SCAN:3,MAP:3,BYROW:3,BYCOL:3,MAKEARRAY:3,OFFSET:4,INDIRECT:4,RAND:3,RANDBETWEEN:3,ISBLANK:1,ISERROR:1,ISNA:1,ISNUMBER:1,ISTEXT:1,ISLOGICAL:1,ISFORMULA:1,ISEVEN:1,ISODD:1,ISREF:1,N:1,TYPE:1,CELL:2,INFO:2,SHEET:1,SHEETS:1,MMULT:3,TRANSPOSE:2,DSUM:2,DAVERAGE:2,DCOUNT:2,DCOUNTA:2,DMAX:2,DMIN:2,DPRODUCT:2,DSTDEV:2,DSTDEVP:2,DVAR:2,DVARP:2,DGET:2,BIN2DEC:1,BIN2HEX:1,BIN2OCT:1,DEC2BIN:1,DEC2HEX:1,DEC2OCT:1,HEX2BIN:1,HEX2DEC:1,HEX2OCT:1,OCT2BIN:1,OCT2DEC:1,OCT2HEX:1,CONVERT:2,ROW:1,ROWS:1,COLUMN:1,COLUMNS:1,AREAS:2,ADDRESS:2,WEBSERVICE:3,FILTERXML:3,ENCODEURL:2};function F(e){return e>=60?"High":e>=30?"Medium":"Low"}function R(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return L(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?L(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw a}}}}function L(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var O=/[+\-*/^&<>]=?|(?<![A-Z])MOD(?![A-Z])/gi,N=/([A-Z_][A-Z0-9_.]*)\s*\(/gi;function M(e,n){var t,r=function(e){if(!e)return"";var n=e.trim();return n.startsWith("=")&&(n=n.substring(1)),n.startsWith("{")&&n.endsWith("}")&&(n=n.substring(1,n.length-1)),n}(e),o=function(e){for(var n=0,t=0,r=[],o=0;o<e.length;o++){var a=e[o];"("===a?(n++,t=Math.max(t,n)):")"===a&&(n=Math.max(0,n-1))}var i,s=R(e.matchAll(N));try{for(s.s();!(i=s.n()).done;){var l=i.value[1].toUpperCase();r.push(l)}}catch(e){s.e(e)}finally{s.f()}return{maxDepth:Math.max(t,1),functionCount:r.length,functionNames:r}}(r),a=o.maxDepth,i=o.functionCount,s=o.functionNames,l=function(e){if(!e)return 0;var n=e.match(O);return n?n.length:0}(r),c=0,u=R(s);try{for(u.s();!(t=u.n()).done;){var d=t.value;c+=I[d]||2}}catch(e){u.e(e)}finally{u.f()}c=Math.min(60,c);var p=Math.min(16,2*Math.max(a-1,0)),f=Math.min(8,Math.ceil(l/4)),m=n?5:0,h=c+p+f+m;return{score:h,band:F(h),breakdown:{functionWeightedScore:c,depthAdj:p,operatorAdj:f,arrayAdj:m},functionCount:i,maxDepth:a,operatorCount:l}}function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function B(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var l=r&&r.prototype instanceof s?r:s,c=Object.create(l.prototype);return D(c,"_invoke",function(t,r,o){var a,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return a=n,s=0,l=e,p.n=t,i}};function f(t,r){for(s=t,l=r,n=0;!d&&c&&!o&&n<u.length;n++){var o,a=u[n],f=p.p,m=a[2];t>3?(o=m===r)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=f&&((o=t<2&&f<a[1])?(s=0,p.v=r,p.n=a[1]):f<m&&(o=t<3||a[0]>r||r>m)&&(a[4]=t,a[5]=r,p.n=m,s=0))}if(o||t>1)return i;throw d=!0,r}return function(o,u,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,m),s=u,l=m;(n=s<2?e:l)||!d;){a||(s?s<3?(s>1&&(p.n=-1),f(s,l)):p.n=l:p.v=l);try{if(c=2,a){if(s||(o="next"),n=a[o]){if(!(n=n.call(a,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,s<2&&(s=0)}else 1===s&&(n=a.return)&&n.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((n=(d=p.n<0)?l:t.call(r,p))!==i)break}catch(n){a=e,s=1,l=n}finally{c=1}}return{value:n,done:d}}}(t,o,a),!0),c}var i={};function s(){}function l(){}function c(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(D(n={},r,function(){return this}),n),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,D(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,D(d,"constructor",c),D(c,"constructor",l),l.displayName="GeneratorFunction",D(c,o,"GeneratorFunction"),D(d),D(d,o,"Generator"),D(d,r,function(){return this}),D(d,"toString",function(){return"[object Generator]"}),(B=function(){return{w:a,m:p}})()}function D(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}D=function(e,n,t,r){if(n)o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t;else{var a=function(n,t){D(e,n,function(e){return this._invoke(n,t,e)})};a("next",0),a("throw",1),a("return",2)}},D(e,n,t,r)}function V(e){return function(e){if(Array.isArray(e))return z(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=_(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw a}}}}function _(e,n){if(e){if("string"==typeof e)return z(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?z(e,n):void 0}}function z(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function U(e,n,t,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void t(e)}s.done?n(l):Promise.resolve(l).then(r,o)}function j(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var a=e.apply(n,t);function i(e){U(a,r,o,i,s,"next",e)}function s(e){U(a,r,o,i,s,"throw",e)}i(void 0)})}}function q(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,G(r.key),r)}}function W(e,n,t){return(n=G(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function G(e){var n=function(e){if("object"!=P(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=P(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==P(n)?n:n+""}var K=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return n=e,t=[{key:"analyzeWorkbook",value:(a=j(B().m(function e(n,t,r){var o,a,i,s,l,c,u,d,p,f,m,h,g,y,b,v,x,w,k,E,C;return B().w(function(e){for(;;)switch(e.n){case 0:return(a=n.workbook.worksheets).load("items/name"),e.n=1,n.sync();case 1:i=new Set(["kCERT_Analysis_Report","kCERT_UFL"]),s=t.targetSheets&&t.targetSheets.length?new Set(t.targetSheets.map(function(e){return e.toLowerCase()})):null,l=a.items.filter(function(e){var n=e.name.toLowerCase();return!i.has(e.name)&&!n.endsWith("_maps")&&(!s||s.has(n))}),c=[],u=0,d=0,p=0,f=0,m=0,h=new Set,g=0,y=H(l),e.p=2,y.s();case 3:if((b=y.n()).done){e.n=6;break}return v=b.value,null==r||r('Starting worksheet "'.concat(v.name,'"')),e.n=4,this.analyzeWorksheetStreaming(n,v,t,r);case 4:return x=e.v,c.push(x),u+=x.totalFormulas,d+=x.cellCountAnalysis.totalCells,p+=x.cellCountAnalysis.cellsWithFormulas,f+=x.cellCountAnalysis.cellsWithValues,m+=x.hardCodedValueAnalysis.totalHardCodedValues,g+=x.uniqueFormulaSummary.ufCount,x.uniqueFormulasList.forEach(function(e){return h.add(e.formula)}),e.n=5,new Promise(function(e){return setTimeout(e,0)});case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,C=e.v,y.e(C);case 8:return e.p=8,y.f(),e.f(8);case 9:return w=[],c.forEach(function(e){w.push.apply(w,V(e.uniqueFormulasList))}),this.assignUniqueFormulaIndicators(w),k=null!==(o=t.minutesPerFormula)&&void 0!==o?o:2,E={ufCount:g,estimatedMinutes:g*k,minutesPerFormula:k},e.a(2,{totalWorksheets:c.length,totalFormulas:u,uniqueFormulas:h.size,worksheets:c,analysisTimestamp:(new Date).toISOString(),totalCells:d,totalCellsWithFormulas:p,totalCellsWithValues:f,totalHardCodedValues:m,uniqueSummary:E})}},e,this,[[2,7,8,9]])})),function(e,n,t){return a.apply(this,arguments)})},{key:"analyzeWorksheetStreaming",value:(o=j(B().m(function n(t,r,o,a){var i,s,l,c,u,d,p,f,m,x,w,k,E,C,A,S,T,I,R,L,O,N,P,D,H,_,z,U,j,q,W,G,K,X,Y,$=this;return B().w(function(n){for(;;)switch(n.n){case 0:return r.load("name"),n.n=1,t.sync();case 1:return(s=r.getUsedRange(!0)).load(["rowCount","columnCount","rowIndex","columnIndex"]),n.n=2,t.sync();case 2:if(!s.isNullObject&&s.rowCount&&s.columnCount){n.n=3;break}return n.a(2,this.emptyResult(r.name,"skipped","no_used_range"));case 3:if(!((l=s.rowCount*s.columnCount)>=e.MASSIVE_THRESHOLD)){n.n=5;break}return null==a||a('Worksheet "'.concat(r.name,'" exceeds ').concat(e.MASSIVE_THRESHOLD," cells, using skim mode")),n.n=4,this.analyzeWorksheetSkim(t,r,s);case 4:return n.a(2,n.v);case 5:c=new Map,u=new Map,d=[],p=0,f=0,m=0,x=0;case 6:if(!(x<s.rowCount)){n.n=11;break}w=Math.min(e.ROW_BLOCK,s.rowCount-x),k=0;case 7:if(!(k<s.columnCount)){n.n=10;break}return E=Math.min(e.COL_BLOCK,s.columnCount-k),(C=this.getBlock(s,x,k,w,E)).load(["formulas","values"]),n.n=8,t.sync();case 8:for(A=C.formulas,S=C.values,null==a||a("Streaming ".concat(r.name,": rows ").concat(s.rowIndex+x+1,"-").concat(s.rowIndex+x+w,", ")+"cols ".concat(s.columnIndex+k+1,"-").concat(s.columnIndex+k+E)),T=0;T<A.length;T++)for(I=0;I<A[T].length;I++)R=A[T][I],L=S[T][I],O=s.rowIndex+x+T,N=s.columnIndex+k+I,P=h(O,N),D="string"==typeof R&&R.startsWith("{="),g(R)?(f++,p++,H=b(R),_=o.groupSimilarFormulas?H:R,(z=c.get(_))||(U=M(R,D),j=this.computeFScore(U,0,D),z={formula:R,normalizedFormula:H,exampleFormula:R,count:0,cells:[],ufIndicator:"",fScore:j,complexity:F(j),complexityDetail:U,isArrayFormula:D},c.set(_,z)),z.count++,z.cells.length<e.MAX_FORMULA_SAMPLE_CELLS&&z.cells.push(P),z.exampleFormula=R,z.complexityDetail=M(R,D),z.fScore=this.computeFScore(z.complexityDetail,z.count,D),z.complexity=F(z.fScore),o.groupSimilarFormulas&&((q=u.get(H))||(q={normalizedFormula:H,exampleFormula:R,totalCount:0,cells:[],isArrayFormula:D,complexityDetail:z.complexityDetail},u.set(H,q)),q.totalCount++,q.cells.length<e.MAX_FORMULA_SAMPLE_CELLS&&q.cells.push(P),q.exampleFormula=R,q.isArrayFormula=D,q.complexityDetail=z.complexityDetail),d.length<e.MAX_HARDCODED_PER_SHEET&&d.push.apply(d,V(this.detectHardCodedValues(R,P)))):y(L)||m++;case 9:k+=e.COL_BLOCK,n.n=7;break;case 10:x+=e.ROW_BLOCK,n.n=6;break;case 11:return W=Math.max(l-f-m,0),G=o.groupSimilarFormulas?Array.from(u.values()).map(function(e){return $.toFormulaInfo(e)}):Array.from(c.values()),K=G.length,X=null!==(i=o.minutesPerFormula)&&void 0!==i?i:2,Y={ufCount:K,estimatedMinutes:K*X,minutesPerFormula:X,reviewedCount:0},n.a(2,{name:r.name,totalCells:l,totalFormulas:p,uniqueFormulas:G.length,uniqueFormulasList:G.sort(function(e,n){return n.count-e.count}),formulaComplexity:this.assessComplexity(p,c),cellCountAnalysis:{totalCells:l,cellsWithFormulas:f,cellsWithValues:m,emptyCells:W,formulaPercentage:v(l>0?f/l*100:0),valuePercentage:v(l>0?m/l*100:0)},hardCodedValueAnalysis:this.finaliseHardCodes(d),analysisMode:"streaming",uniqueFormulaSummary:Y})}},n,this)})),function(e,n,t,r){return o.apply(this,arguments)})},{key:"analyzeWorksheetSkim",value:(r=j(B().m(function e(n,t,r){var o,a,i,s,l,c,u,d,p;return B().w(function(e){for(;;)switch(e.n){case 0:return o=r.rowCount*r.columnCount,a=0,i=0,s=r.getSpecialCellsOrNullObject(Excel.SpecialCellType.formulas),l=r.getSpecialCellsOrNullObject(Excel.SpecialCellType.constants),s.load("address"),l.load("address"),c=null,u=null,e.p=1,s.isNullObject||(c=s.getCellCount()),l.isNullObject||(u=l.getCellCount()),e.n=2,n.sync();case 2:a=c?c.value:0,i=u?u.value:0,e.n=4;break;case 3:e.p=3,p=e.v,console.warn('Skim mode special cells failed for worksheet "'.concat(t.name,'"'),p);case 4:return d=Math.max(o-a-i,0),e.a(2,{name:t.name,totalCells:o,totalFormulas:a,uniqueFormulas:0,uniqueFormulasList:[],formulaComplexity:"High",cellCountAnalysis:{totalCells:o,cellsWithFormulas:a,cellsWithValues:i,emptyCells:d,formulaPercentage:v(o>0?a/o*100:0),valuePercentage:v(o>0?i/o*100:0)},hardCodedValueAnalysis:{totalHardCodedValues:0,highSeverityValues:[],mediumSeverityValues:[],lowSeverityValues:[],infoSeverityValues:[],repeatedValues:[],undocumentedParameters:[]},analysisMode:"massive-skim",fallbackReason:"massive_threshold",uniqueFormulaSummary:{ufCount:0,estimatedMinutes:0,minutesPerFormula:2,reviewedCount:0}})}},e,null,[[1,3]])})),function(e,n,t){return r.apply(this,arguments)})},{key:"detectHardCodedValues",value:function(e,n){var t=this;return g(e)?function(e){if(!e.startsWith("="))return[];var n,t=e.trimStart().replace(/^=/,"");try{n=function(e){var n=(0,x.q)(e),t=[],r=0;return n.forEach(function(n,o){var a="string"==typeof n.value?n.value:"";if(a){var i=e.indexOf(a,r),s=i>=0?i:r;t.push({value:a,type:n.type,subtype:n.subtype,index:s,length:a.length,originalIndex:o}),r=s+a.length}else t.push({value:"",type:n.type,subtype:n.subtype,index:r,length:0,originalIndex:o})}),t}(t)}catch(e){return console.warn("HardCodeDetector: tokenizer failed; falling back to regex",e),function(e){for(var n,t=[],r=/-?\d+(?:\.\d+)?/g,o=/"([^"\r\n]*)"/g;null!==(n=r.exec(e));)t.push({kind:"numeric",value:n[0],display:n[0],index:n.index,length:n[0].length});for(;null!==(n=o.exec(e));)t.push({kind:"string",value:n[1],display:'"'.concat(n[1],'"'),index:n.index,length:n[0].length});return t}(t)}var r=[],o=[];return n.forEach(function(e,t){if("function"!==e.type)if("argument"!==e.type){var a,i=o.length?o[o.length-1]:null;if("operand"===e.type)switch(e.subtype){case"number":r.push(function(e,n,t,r){var o,a,i=function(e,n,t,r,o){var a=e.trim(),i=r[o+1];if(i&&"operator-postfix"===i.type&&"%"===i.value){var s=Number(a);return{kind:"percentage",display:"".concat(a,"%"),absoluteValue:Math.abs(s),isLikelyInput:!0,containsMixedTypes:!1,rationale:"Percentage literal embedded in formula.",suggestedFix:"Consider referencing a named percentage input instead of hard-coding."}}var l,c=Number(a),u=Number.isInteger(c),d=Math.abs(c),p=d>=1;if(n){var f=n.toUpperCase();w.has(f)&&(0===t&&4===a.length?(p=!0,l="Year literal supplied to date function."):t<=2&&u&&(p=!0,l="Day or month literal supplied to date function.")),k.has(f)&&u&&t<=2&&(p=!0,l="Time component literal supplied to time function.")}return{kind:"numeric",display:a,absoluteValue:d,isLikelyInput:p,containsMixedTypes:!1,rationale:l,suggestedFix:void 0}}(e.value,null!==(o=null==n?void 0:n.functionName)&&void 0!==o?o:null,null!==(a=null==n?void 0:n.argumentIndex)&&void 0!==a?a:0,t,r);return{kind:i.kind,value:e.value,display:i.display,index:e.index,length:e.length,absoluteValue:i.absoluteValue,isLikelyInput:i.isLikelyInput,containsMixedTypes:i.containsMixedTypes,rationale:i.rationale,suggestedFix:i.suggestedFix}}(e,i,n,t));break;case"logical":r.push(function(e){var n=e.value.toUpperCase();return{kind:"boolean",value:n,display:n,index:e.index,length:e.length,isFlag:"TRUE"===n||"FALSE"===n}}(e));break;case"text":r.push(function(e,n){var t,r,o=e.value,a=null!==(t=null==n||null===(r=n.functionName)||void 0===r?void 0:r.toUpperCase())&&void 0!==t?t:null,i='"'.concat(o,'"');return E.has(o)?{kind:"string",value:o,display:i,index:e.index,length:e.length+2,isFlag:!0}:C.has(o.toUpperCase())?{kind:"named-literal",value:o,display:i,index:e.index,length:e.length+2,isRecognizedConstant:!0}:a&&w.has(a)||T.test(o)?{kind:"date",value:o,display:i,index:e.index,length:e.length+2,isLikelyInput:!0,rationale:"Date literal embedded directly in formula."}:a&&k.has(a)||S.test(o)?{kind:"time",value:o,display:i,index:e.index,length:e.length+2,isLikelyInput:!0}:A.test(o)?{kind:"hexadecimal",value:o,display:i,index:e.index,length:e.length+2}:{kind:"string",value:o,display:i,index:e.index,length:e.length+2}}(e,i));break;case"range":a=e.value,/!/.test(a)&&r.push(function(e){return{kind:"external",value:e.value,display:e.value,index:e.index,length:e.length,isLinkedWorkbook:e.value.includes("[")}}(e))}}else o.length&&(o[o.length-1].argumentIndex+=1);else"start"===e.subtype?o.push({functionName:e.value||null,argumentIndex:0}):"stop"===e.subtype&&o.pop()}),function(e,n){var t=[],r=[];e.forEach(function(e,n){if("function"===e.type&&"ARRAY"===e.value&&"start"===e.subtype)r.push(n);else if("function"===e.type&&"stop"===e.subtype&&r.length){var o=r.pop();void 0!==o&&t.push({start:o,end:n})}}),0!==t.length&&n.forEach(function(n){var r=function(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(n>=r.index&&n<r.index+Math.max(r.length,1))return t}return-1}(e,n.index);-1!==r&&t.some(function(e){return r>=e.start&&r<=e.end})&&(n.kind="numeric"===n.kind?"array":n.kind,n.containsMixedTypes=!0)})}(n,r),r.filter(function(e){return!function(e){return!("boolean"!==e.kind||!e.isFlag)||!("named-literal"!==e.kind||!e.isRecognizedConstant)||!("string"!==e.kind||!e.isFlag)}(e)})}(e).map(function(r){var o,a,i=t.mapLiteralSeverity(r);return i?{value:r.display,severity:i,context:t.snippet(e,r.index,80),cellAddress:n,rationale:null!==(o=r.rationale)&&void 0!==o?o:t.rationaleForSeverity(i,r.display),suggestedFix:null!==(a=r.suggestedFix)&&void 0!==a?a:t.fixForSeverity(i),isRepeated:!1,repetitionCount:0}:null}).filter(function(e){return null!==e}):[]}},{key:"mapLiteralSeverity",value:function(e){switch(e.kind){case"numeric":return this.severityForNumber(e.value);case"percentage":return void 0===e.absoluteValue?"Info":e.absoluteValue>=100?"High":e.absoluteValue>=10?"Medium":"Low";case"string":return e.isFlag?null:e.value.length>=6?"Medium":e.value.length>=3?"Low":"Info";case"boolean":return e.isFlag?null:"Info";case"date":case"time":return e.isLikelyInput?"Medium":"Low";case"array":return e.containsMixedTypes?"High":"Medium";case"named-literal":return e.isRecognizedConstant?null:"Low";case"external":return e.isLinkedWorkbook?"Info":"Low";case"hexadecimal":return"High";default:return"Info"}}},{key:"finaliseHardCodes",value:function(e){if(0===e.length)return{totalHardCodedValues:0,highSeverityValues:[],mediumSeverityValues:[],lowSeverityValues:[],infoSeverityValues:[],repeatedValues:[],undocumentedParameters:[]};var n=new Map;e.forEach(function(e){var t=e.value;n.has(t)||n.set(t,[]),n.get(t).push(e)});var t=[];return n.forEach(function(e){e.length>1&&e.forEach(function(n){n.isRepeated=!0,n.repetitionCount=e.length,t.push(n)})}),{totalHardCodedValues:e.length,highSeverityValues:e.filter(function(e){return"High"===e.severity}),mediumSeverityValues:e.filter(function(e){return"Medium"===e.severity}),lowSeverityValues:e.filter(function(e){return"Low"===e.severity}),infoSeverityValues:e.filter(function(e){return"Info"===e.severity}),repeatedValues:t,undocumentedParameters:e.filter(function(e){return("High"===e.severity||"Medium"===e.severity)&&e.isRepeated})}}},{key:"assignUniqueFormulaIndicators",value:function(e){var n=1,t=1;e.forEach(function(e){var r=e.formula.startsWith("{="),o=r?"A":"U",a=r?n++:t++;e.ufIndicator="".concat(o).concat(a.toString().padStart(4,"0"))})}},{key:"assessComplexity",value:function(e,n){if(0===e)return"Low";var t=n.size,r=t/e,o=0;return e>5e3?o+=2:e>500&&(o+=1),r>.5?o+=2:r>.3&&(o+=1),t>200&&(o+=1),o>=4?"High":o>=2?"Medium":"Low"}},{key:"emptyResult",value:function(e,n,t){return{name:e,totalCells:0,totalFormulas:0,uniqueFormulas:0,uniqueFormulasList:[],formulaComplexity:"Low",cellCountAnalysis:{totalCells:0,cellsWithFormulas:0,cellsWithValues:0,emptyCells:0,formulaPercentage:0,valuePercentage:0},hardCodedValueAnalysis:{totalHardCodedValues:0,highSeverityValues:[],mediumSeverityValues:[],lowSeverityValues:[],infoSeverityValues:[],repeatedValues:[],undocumentedParameters:[]},analysisMode:n,fallbackReason:t,uniqueFormulaSummary:{ufCount:0,estimatedMinutes:0,minutesPerFormula:2,reviewedCount:0}}}},{key:"getBlock",value:function(e,n,t,r,o){return e.getCell(n,t).getResizedRange(r-1,o-1)}},{key:"severityForNumber",value:function(e){var n=Number(e);return Number.isNaN(n)?"Info":Math.abs(n)>=1e3||e.includes(".")?"High":Math.abs(n)>=100?"Medium":Math.abs(n)>=10?"Low":"Info"}},{key:"rationaleForSeverity",value:function(e,n){switch(e){case"High":return"Large or precise literal ".concat(n," embedded in formula.");case"Medium":return"Potential driver literal ".concat(n," detected inside formula.");case"Low":return"Literal ".concat(n," may be a configuration constant.");default:return"Literal ".concat(n," found in formula.")}}},{key:"fixForSeverity",value:function(e){switch(e){case"High":return"Move value to an inputs sheet and reference it.";case"Medium":return"Consider referencing a named range instead of embedding the literal.";case"Low":return"Review whether this literal should be parameterised.";default:return"Confirm with modelling standards whether this literal is acceptable."}}},{key:"snippet",value:function(e,n,t){var r=Math.max(0,n-Math.floor(t/2)),o=Math.min(e.length,n+Math.floor(t/2)),a=e.substring(r,o);return r>0&&(a="…"+a),o<e.length&&(a+="…"),a}},{key:"toFormulaInfo",value:function(e){var n=e.complexityDetail,t=this.computeFScore(n,e.totalCount,e.isArrayFormula);return{formula:e.exampleFormula,normalizedFormula:e.normalizedFormula,exampleFormula:e.exampleFormula,count:e.totalCount,cells:e.cells,ufIndicator:"",fScore:t,complexity:F(t),complexityDetail:n,isArrayFormula:e.isArrayFormula}}},{key:"computeFScore",value:function(e,n,t){var r=e.score;return n>100?r+=4:n>20&&(r+=2),Math.min(99,Math.max(0,r))}}],t&&q(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,r,o,a}();function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function Y(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return $(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?$(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw a}}}}function $(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function J(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var l=r&&r.prototype instanceof s?r:s,c=Object.create(l.prototype);return Q(c,"_invoke",function(t,r,o){var a,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return a=n,s=0,l=e,p.n=t,i}};function f(t,r){for(s=t,l=r,n=0;!d&&c&&!o&&n<u.length;n++){var o,a=u[n],f=p.p,m=a[2];t>3?(o=m===r)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=f&&((o=t<2&&f<a[1])?(s=0,p.v=r,p.n=a[1]):f<m&&(o=t<3||a[0]>r||r>m)&&(a[4]=t,a[5]=r,p.n=m,s=0))}if(o||t>1)return i;throw d=!0,r}return function(o,u,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,m),s=u,l=m;(n=s<2?e:l)||!d;){a||(s?s<3?(s>1&&(p.n=-1),f(s,l)):p.n=l:p.v=l);try{if(c=2,a){if(s||(o="next"),n=a[o]){if(!(n=n.call(a,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,s<2&&(s=0)}else 1===s&&(n=a.return)&&n.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((n=(d=p.n<0)?l:t.call(r,p))!==i)break}catch(n){a=e,s=1,l=n}finally{c=1}}return{value:n,done:d}}}(t,o,a),!0),c}var i={};function s(){}function l(){}function c(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(Q(n={},r,function(){return this}),n),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,Q(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,Q(d,"constructor",c),Q(c,"constructor",l),l.displayName="GeneratorFunction",Q(c,o,"GeneratorFunction"),Q(d),Q(d,o,"Generator"),Q(d,r,function(){return this}),Q(d,"toString",function(){return"[object Generator]"}),(J=function(){return{w:a,m:p}})()}function Q(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Q=function(e,n,t,r){if(n)o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t;else{var a=function(n,t){Q(e,n,function(e){return this._invoke(n,t,e)})};a("next",0),a("throw",1),a("return",2)}},Q(e,n,t,r)}function Z(e,n,t,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void t(e)}s.done?n(l):Promise.resolve(l).then(r,o)}function ee(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var a=e.apply(n,t);function i(e){Z(a,r,o,i,s,"next",e)}function s(e){Z(a,r,o,i,s,"throw",e)}i(void 0)})}}function ne(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,re(r.key),r)}}function te(e,n,t){return(n=re(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function re(e){var n=function(e){if("object"!=X(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=X(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==X(n)?n:n+""}W(K,"ROW_BLOCK",200),W(K,"COL_BLOCK",120),W(K,"MASSIVE_THRESHOLD",15e4),W(K,"MAX_FORMULA_SAMPLE_CELLS",200),W(K,"MAX_HARDCODED_PER_SHEET",400);var oe=function(){return{F:0,"<":0,"^":0,"+":0,L:0,N:0,A:0}},ae=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{includeHidden:!0};!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=n}return n=e,t=[{key:"generate",value:(o=ee(J().m(function n(t,r,o){var a,i,s,l,c,u,d,p,f,m,h,g,y,b,v,x,w,k,E,C,A,S,T,I,F,R,L,O,N,M,P,B,D,V,H,_;return J().w(function(n){for(;;)switch(n.n){case 0:return r.load(["name"]),n.n=1,t.sync();case 1:return(i=r.getUsedRange(this.options.includeHidden)).load(["rowCount","columnCount","address","rowIndex","columnIndex"]),n.n=2,t.sync();case 2:if(!i.isNullObject&&i.rowCount&&i.columnCount){n.n=3;break}return n.a(2,this.emptyResult(r.name,null!==(s=i.address)&&void 0!==s?s:"A1",null!==(l=i.rowIndex)&&void 0!==l?l:0,null!==(c=i.columnIndex)&&void 0!==c?c:0,"no_used_range"));case 3:if(u=i.rowCount*i.columnCount,d=null!==(a=this.options.maxCells)&&void 0!==a?a:e.MAX_DEFAULT_CELLS,!(u>d)){n.n=4;break}return n.a(2,this.emptyResult(r.name,i.address,i.rowIndex,i.columnIndex,"exceeds_max_cells_".concat(d)));case 4:p=i.rowCount,f=i.columnCount,m=i.rowIndex,h=i.columnIndex,g=Array.from({length:p},function(){return new Array(f).fill("")}),y=oe(),b=[],v=new Map,x=new Array(p).fill(null),w=new Array(f).fill(null),k=0;case 5:if(!(k<p)){n.n=10;break}E=Math.min(e.ROW_BLOCK,p-k),C=0;case 6:if(!(C<f)){n.n=9;break}return A=Math.min(e.COL_BLOCK,f-C),(S=i.getCell(k,C).getResizedRange(E-1,A-1)).load(["rowIndex","columnIndex","formulasR1C1","values","text"]),n.n=7,t.sync();case 7:for(T=S.formulasR1C1,I=S.values,F=S.text,R=m+k+1,L=h+C+1,null==o||o("Mapping ".concat(r.name,": rows ").concat(R,"-").concat(R+E-1,", cols ").concat(L,"-").concat(L+A-1)),O=0;O<E;O++)for(N=0;N<A;N++)M=k+O,P=C+N,B=T[O][N],D=I[O][N],V=F[O][N],H=this.classifyCell(r,m+M,h+P,B,D,V,M,P,x,w,y,v),g[M][P]=H;case 8:C+=e.COL_BLOCK,n.n=6;break;case 9:k+=e.ROW_BLOCK,n.n=5;break;case 10:return n.n=11,this.promoteDynamicArrays(t,r,i,p,f,v,g,y,b);case 11:return _=this.analyseAnomalies(g),n.a(2,{worksheetName:r.name,usedRangeAddress:i.address,startRow:m,startColumn:h,rowCount:p,columnCount:f,symbols:g,counts:y,arrayAreas:b,anomalies:_})}},n,this)})),function(e,n,t){return o.apply(this,arguments)})},{key:"classifyCell",value:function(e,n,t,r,o,a,i,s,l,c,u,d){var p="string"==typeof r?r.trim():"";if(p.startsWith("{=")&&p.endsWith("}"))return l[i]=null,c[s]=null,u.A++,"A";if(p&&g(p)){if(p.includes("#")){var f="".concat(n,":").concat(t);d.has(f)||d.set(f,{absoluteRow:n,absoluteColumn:t})}var m,h=s>0?l[i]:null,b=c[s];return m=h===p&&b===p?"+":h===p?"<":b===p?"^":"F",l[i]=p,c[s]=p,u[m]++,m}return l[i]=null,c[s]=null,y(o)?a&&a.trim().length>0?(u.L++,"L"):"":"number"==typeof o||"boolean"==typeof o?(u.N++,"N"):(u.L++,"L")}},{key:"promoteDynamicArrays",value:(r=ee(J().m(function e(n,t,r,o,a,i,s,l,c){var u,d,p,f,m,h,g,y,b,v,x,w,k,E,C,A;return J().w(function(e){for(;;)switch(e.n){case 0:if(0!==i.size){e.n=1;break}return e.a(2);case 1:u=Array.from(i.values()),d=r.rowIndex,p=r.columnIndex,f=0,m=u;case 2:if(!(f<m.length)){e.n=13;break}return h=m[f],g=t.getCell(h.absoluteRow,h.absoluteColumn),(y=g.getSpillingToRangeOrNullObject()).load(["isNullObject","rowIndex","columnIndex","rowCount","columnCount"]),e.n=3,n.sync();case 3:if(!y.isNullObject){e.n=4;break}return e.a(3,12);case 4:if(b=y.rowIndex-d,v=y.columnIndex-p,x=b+y.rowCount-1,w=v+y.columnCount-1,!(b<0||v<0||x>=o||w>=a)){e.n=5;break}return e.a(3,12);case 5:k=0,E=b;case 6:if(!(E<=x)){e.n=11;break}C=v;case 7:if(!(C<=w)){e.n=10;break}if("A"!==(A=s[E][C])){e.n=8;break}return e.a(3,9);case 8:A&&""!==A&&(l[A]=Math.max(0,l[A]-1)),s[E][C]="A",k++;case 9:C++,e.n=7;break;case 10:E++,e.n=6;break;case 11:k>0&&(l.A+=k,c.push({top:b,left:v,bottom:x,right:w}));case 12:f++,e.n=2;break;case 13:return e.a(2)}},e)})),function(e,n,t,o,a,i,s,l,c){return r.apply(this,arguments)})},{key:"analyseAnomalies",value:function(e){var n=0,t=0,r=0,o=e.length;if(0===o)return{changeOfDirection:n,horizontalBreaks:t,verticalBreaks:r};var a,i=e[0].length,s=Y(e);try{for(s.s();!(a=s.n()).done;){var l,c=a.value,u=null,d=!1,p=Y(c);try{for(p.s();!(l=p.n()).done;){var f=l.value;"<"===f||"+"===f?(u&&"left"!==u&&n++,u="left",d=!0):"^"===f?(u&&"up"!==u&&n++,u="up",d=!0):"N"===f||"L"===f||""===f?(d&&t++,d=!1,u=null):(d=!1,u=null)}}catch(e){p.e(e)}finally{p.f()}}}catch(e){s.e(e)}finally{s.f()}for(var m=0;m<i;m++)for(var h=!1,g=0;g<o;g++){var y=e[g][m];"^"===y||"+"===y?h=!0:"N"===y||"L"===y||""===y?(h&&r++,h=!1):h=!1}return{changeOfDirection:n,horizontalBreaks:t,verticalBreaks:r}}},{key:"emptyResult",value:function(e,n,t,r,o){return{worksheetName:e,usedRangeAddress:n,startRow:t,startColumn:r,rowCount:0,columnCount:0,symbols:[],counts:{F:0,"<":0,"^":0,"+":0,L:0,N:0,A:0},arrayAreas:[],anomalies:{changeOfDirection:0,horizontalBreaks:0,verticalBreaks:0},skipped:!0,skipReason:o}}}],t&&ne(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,r,o}();function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function se(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=me(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw a}}}}function le(){var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function a(t,r,o,a){var l=r&&r.prototype instanceof s?r:s,c=Object.create(l.prototype);return ce(c,"_invoke",function(t,r,o){var a,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return a=n,s=0,l=e,p.n=t,i}};function f(t,r){for(s=t,l=r,n=0;!d&&c&&!o&&n<u.length;n++){var o,a=u[n],f=p.p,m=a[2];t>3?(o=m===r)&&(l=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=f&&((o=t<2&&f<a[1])?(s=0,p.v=r,p.n=a[1]):f<m&&(o=t<3||a[0]>r||r>m)&&(a[4]=t,a[5]=r,p.n=m,s=0))}if(o||t>1)return i;throw d=!0,r}return function(o,u,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,m),s=u,l=m;(n=s<2?e:l)||!d;){a||(s?s<3?(s>1&&(p.n=-1),f(s,l)):p.n=l:p.v=l);try{if(c=2,a){if(s||(o="next"),n=a[o]){if(!(n=n.call(a,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,s<2&&(s=0)}else 1===s&&(n=a.return)&&n.call(a),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((n=(d=p.n<0)?l:t.call(r,p))!==i)break}catch(n){a=e,s=1,l=n}finally{c=1}}return{value:n,done:d}}}(t,o,a),!0),c}var i={};function s(){}function l(){}function c(){}n=Object.getPrototypeOf;var u=[][r]?n(n([][r]())):(ce(n={},r,function(){return this}),n),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,ce(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,ce(d,"constructor",c),ce(c,"constructor",l),l.displayName="GeneratorFunction",ce(c,o,"GeneratorFunction"),ce(d),ce(d,o,"Generator"),ce(d,r,function(){return this}),ce(d,"toString",function(){return"[object Generator]"}),(le=function(){return{w:a,m:p}})()}function ce(e,n,t,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ce=function(e,n,t,r){if(n)o?o(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t;else{var a=function(n,t){ce(e,n,function(e){return this._invoke(n,t,e)})};a("next",0),a("throw",1),a("return",2)}},ce(e,n,t,r)}function ue(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function de(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ue(Object(t),!0).forEach(function(n){pe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ue(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function pe(e,n,t){return(n=function(e){var n=function(e){if("object"!=ie(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=ie(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ie(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function fe(e){return function(e){if(Array.isArray(e))return he(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||me(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(e,n){if(e){if("string"==typeof e)return he(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?he(e,n):void 0}}function he(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function ge(e,n,t,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void t(e)}s.done?n(l):Promise.resolve(l).then(r,o)}function ye(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var a=e.apply(n,t);function i(e){ge(a,r,o,i,s,"next",e)}function s(e){ge(a,r,o,i,s,"throw",e)}i(void 0)})}}te(ae,"ROW_BLOCK",200),te(ae,"COL_BLOCK",120),te(ae,"MAX_DEFAULT_CELLS",25e4),Office.onReady(function(e){var n,t,r,o,a,i,s,l,c,u,d,p,f,m,h,g,y,b,v,x,w,k;e.host===Office.HostType.Excel&&(null===(n=document.getElementById("analyzeFormulas"))||void 0===n||n.addEventListener("click",Te),null===(t=document.getElementById("generateMaps"))||void 0===t||t.addEventListener("click",De),null===(r=document.getElementById("refreshMapSheets"))||void 0===r||r.addEventListener("click",Xe),null===(o=document.getElementById("selectAllMapSheets"))||void 0===o||o.addEventListener("click",function(){return Be(!0)}),null===(a=document.getElementById("clearAllMapSheets"))||void 0===a||a.addEventListener("click",function(){return Be(!1)}),null===(i=document.getElementById("exportResults"))||void 0===i||i.addEventListener("click",Re),null===(s=document.getElementById("generateAuditTrail"))||void 0===s||s.addEventListener("click",Oe),null===(l=document.getElementById("analysisScope"))||void 0===l||l.addEventListener("change",Rn),null===(c=document.getElementById("minutesPerFormula"))||void 0===c||c.addEventListener("change",Fn),null===(u=document.getElementById("listingReviewedFilter"))||void 0===u||u.addEventListener("change",function(){we.showReviewedOnly=document.getElementById("listingReviewedFilter").checked,be&&en(be)}),null===(d=document.getElementById("listingSearch"))||void 0===d||d.addEventListener("input",function(e){we.searchTerm=e.target.value.trim().toLowerCase(),be&&en(be)}),null===(p=document.getElementById("exportListing"))||void 0===p||p.addEventListener("click",On),null===(f=document.getElementById("colorApply"))||void 0===f||f.addEventListener("click",function(){return Mn(!1)}),null===(m=document.getElementById("colorReset"))||void 0===m||m.addEventListener("click",function(){return Mn(!0)}),null===(h=document.getElementById("gptSettings"))||void 0===h||h.addEventListener("click",ln),null===(g=document.getElementById("saveGptSettings"))||void 0===g||g.addEventListener("click",un),null===(y=document.getElementById("cancelGptSettings"))||void 0===y||y.addEventListener("click",cn),null===(b=document.getElementById("closeGptSettings"))||void 0===b||b.addEventListener("click",cn),null===(v=document.getElementById("closeGptResponse"))||void 0===v||v.addEventListener("click",yn),null===(x=document.getElementById("closeGptResponseBtn"))||void 0===x||x.addEventListener("click",yn),null===(w=document.getElementById("askGptWorkbook"))||void 0===w||w.addEventListener("click",function(){be&&function(e){En.apply(this,arguments)}(be)}),ke.forEach(function(e){var n=document.getElementById("analysisTab_".concat(e.replace("View","")));null==n||n.addEventListener("click",function(){return In(e)})}),(k=document.getElementById("sheetScopePicker"))&&(k.hidden=!0),In("summaryView"),Xe(),Je([]),fn())});var be=null,ve=null,xe=2,we={showReviewedOnly:!1,searchTerm:""},ke=["summaryView","listingView","mapsView","colorView"],Ee=[],Ce={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function Ae(e,n){var t=document.getElementById(e);t&&(t.textContent=n)}var Se=function(e){if(null==e)return"0";var n=Number(e);return Number.isFinite(n)?n.toLocaleString():"0"};function Te(){return Ie.apply(this,arguments)}function Ie(){return Ie=ye(le().m(function e(){var n,t,r;return le().w(function(e){for(;;)switch(e.n){case 0:return e.p=0,Me(!0),We("Starting formula analysis (vNext massive-model fix)...","info"),n={includeEmptyCells:document.getElementById("includeEmptyCells").checked,groupSimilarFormulas:document.getElementById("groupSimilarFormulas").checked,targetSheets:Ee.length?Ee:void 0,minutesPerFormula:xe},e.n=1,Excel.run(function(){var e=ye(le().m(function e(t){var r,o,a,i;return le().w(function(e){for(;;)switch(e.n){case 0:return r=new K,o=function(e){We(e,"info")},We("Analyzing workbook structure (streaming batches)...","info"),e.n=1,r.analyzeWorkbook(t,n,o);case 1:(a=e.v).totalCells>5e4&&We("MASSIVE MODEL detected - streaming + safe fallback engaged","info"),be=a,Fe(a),Qe(a),en(a),We((i=a.totalCells)>1e5?"Analysis completed! Processed ".concat(Se(i)," cells across ").concat(Se(a.totalWorksheets)," worksheets."):"Formula analysis completed successfully!","success");case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,r=e.v,console.error("Error analyzing formulas:",r),(t=Ge(r)).includes("Maximum call stack size exceeded")?We("STACK OVERFLOW ERROR - Using optimized version v6.0 with NULL-SAFE HARD-CODED DETECTION. Please check if you're using the latest build. Error: ".concat(t),"error"):We("Error during analysis: ".concat(t),"error");case 3:return e.p=3,Me(!1),e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])})),Ie.apply(this,arguments)}function Fe(e){Ae("totalWorksheets",Se(e.totalWorksheets)),Ae("totalFormulas",Se(e.totalFormulas)),Ae("uniqueFormulas",Se(e.uniqueFormulas)),Ae("totalHardCodedValues",Se(e.totalHardCodedValues)),Ae("totalCells",Se(e.totalCells)),Ae("cellsWithFormulas",Se(e.totalCellsWithFormulas)),Ae("cellsWithValues",Se(e.totalCellsWithValues)),Ae("emptyCells",Se(e.totalCells-e.totalCellsWithFormulas-e.totalCellsWithValues));var n=e.worksheets.reduce(function(e,n){var t,r=n.hardCodedValueAnalysis;return e+((null==r||null===(t=r.highSeverityValues)||void 0===t?void 0:t.length)||0)},0),t=e.worksheets.reduce(function(e,n){var t,r=n.hardCodedValueAnalysis;return e+((null==r||null===(t=r.mediumSeverityValues)||void 0===t?void 0:t.length)||0)},0),r=e.worksheets.reduce(function(e,n){var t,r=n.hardCodedValueAnalysis;return e+((null==r||null===(t=r.lowSeverityValues)||void 0===t?void 0:t.length)||0)},0);e.worksheets.reduce(function(e,n){var t,r=n.hardCodedValueAnalysis;return e+((null==r||null===(t=r.infoSeverityValues)||void 0===t?void 0:t.length)||0)},0),Ae("highConfidenceValues",Se(n)),Ae("mediumConfidenceValues",Se(t)),Ae("lowConfidenceValues",Se(r)),function(e){var n=document.getElementById("hardCodedValuesList");if(n){n.innerHTML="";var t=[];if(e.forEach(function(e){var n=e.hardCodedValueAnalysis;n&&t.push.apply(t,fe(n.highSeverityValues||[]).concat(fe(n.mediumSeverityValues||[]),fe(n.lowSeverityValues||[])))}),t.sort(function(e,n){var t={High:0,Medium:1,Low:2,Info:3};return t[e.severity]!==t[n.severity]?t[e.severity]-t[n.severity]:e.value.localeCompare(n.value)}),t.slice(0,50).forEach(function(e){var t=function(e){var n=document.createElement("div");n.className="hard-coded-value-item ".concat(e.severity.toLowerCase(),"-confidence");var t=e.isRepeated?" (Repeated ".concat(Se(e.repetitionCount)," times)"):"",r=e.isInconsistent?'<span class="inconsistency-badge '.concat(e.inconsistencyType,'">').concat(function(e){switch(e){case"value_mismatch":return"Inconsistent Value";case"range_endpoint":return"Fixed Range";case"pattern_deviation":return"Pattern Deviation";case"isolated_hardcode":return"Isolated Hard-code";default:return"Inconsistent"}}(e.inconsistencyType),"</span>"):"",o="";return e.nearbyPatterns&&e.nearbyPatterns.length>0&&(o='<div class="nearby-patterns">\n            <strong>Nearby formulas:</strong>\n            <ul>'.concat(e.nearbyPatterns.map(function(e){return"<li>".concat(Ke(e),"</li>")}).join(""),"</ul>\n        </div>")),n.innerHTML='\n        <div class="hard-coded-value-header">\n            <span class="hard-coded-value-address">'.concat(e.cellAddress,'</span>\n            <span class="hard-coded-value-confidence ').concat(e.severity.toLowerCase(),'">').concat(e.severity,"</span>\n            ").concat(r,'\n        </div>\n        <div class="hard-coded-value-content">').concat(Ke(e.context),'</div>\n        <div class="hard-coded-value-reason">\n            <strong>Value:</strong> "').concat(e.value,'"').concat(t,"<br>\n            <strong>Issue:</strong> ").concat(e.rationale,"<br>\n            <strong>Suggested Fix:</strong> ").concat(e.suggestedFix,"\n            ").concat(e.expectedPattern?"<br><strong>Expected:</strong> ".concat(e.expectedPattern):"","\n        </div>\n        ").concat(o,"\n    "),n}(e);n.appendChild(t)}),t.length>50){var r=document.createElement("div");r.className="hard-coded-value-item",r.innerHTML='<div class="hard-coded-value-content">... and '.concat(Se(t.length-50)," more hard-coded values</div>"),n.appendChild(r)}}}(e.worksheets);var o=document.getElementById("worksheetDetails");o&&(o.innerHTML="",e.worksheets.forEach(function(e){var n=function(e){var n,t=document.createElement("div");return t.className="worksheet-card",t.innerHTML='\n        <div class="worksheet-header">\n            <div class="worksheet-name">'.concat(e.name,'</div>\n            <div class="worksheet-mode">\n                <span class="mode-pill">').concat(e.analysisMode||"streaming","</span>\n                ").concat(e.fallbackReason?'<span class="fallback-note">'.concat(e.fallbackReason,"</span>"):"",'\n            </div>\n        </div>\n        <div class="worksheet-stats">\n            <div class="worksheet-stat">\n                <span class="worksheet-stat-number">').concat(Se(e.totalFormulas),'</span>\n                <span class="worksheet-stat-label">Total Formulas</span>\n            </div>\n            <div class="worksheet-stat">\n                <span class="worksheet-stat-number">').concat(Se(e.uniqueFormulas),'</span>\n                <span class="worksheet-stat-label">Unique Formulas</span>\n            </div>\n            <div class="worksheet-stat">\n                <span class="worksheet-stat-number">').concat(Se(e.cellCountAnalysis.totalCells),'</span>\n                <span class="worksheet-stat-label">Total Cells</span>\n            </div>\n            <div class="worksheet-stat">\n                <span class="worksheet-stat-number">').concat(e.formulaComplexity,'</span>\n                <span class="worksheet-stat-label">Complexity</span>\n            </div>\n            <div class="worksheet-stat">\n                <span class="worksheet-stat-number">').concat(Se((null===(n=e.hardCodedValueAnalysis)||void 0===n?void 0:n.totalHardCodedValues)||0),'</span>\n                <span class="worksheet-stat-label">Hard-coded</span>\n            </div>\n        </div>\n        <div class="formula-list" id="formulaList_').concat(e.name.replace(/\s+/g,"_"),'">\n            <h4>Unique Formulas:</h4>\n            <div class="worksheet-meta">\n                <span class="worksheet-mode">Mode: ').concat(e.analysisMode||"standard").concat(e.fallbackReason?" (".concat(e.fallbackReason,")"):"","</span>\n            </div>\n            ").concat(e.uniqueFormulasList.map(function(e){return'\n                <div class="formula-item">\n                    <div class="formula-text">'.concat(Ke(e.formula),'</div>\n                    <div class="formula-count">Used ').concat(Se(e.count)," time(s)</div>\n                </div>\n            ")}).join(""),"\n        </div>\n    "),t}(e);o.appendChild(n)})),document.getElementById("resultsSection").style.display="block"}function Re(){return Le.apply(this,arguments)}function Le(){return Le=ye(le().m(function e(){var n,t;return le().w(function(e){for(;;)switch(e.n){case 0:if(be){e.n=1;break}return We("No analysis results to export. Please run analysis first.","warning"),e.a(2);case 1:return e.p=1,We("Exporting analysis results...","info"),e.n=2,Excel.run(function(){var e=ye(le().m(function e(n){var t,r,o,a,i,s,l,c;return le().w(function(e){for(;;)switch(e.n){case 0:return(i=n.workbook.worksheets.getItemOrNullObject("kCERT_Analysis_Report")).load("name"),e.n=1,n.sync();case 1:if(i.isNullObject){e.n=2;break}return i.delete(),e.n=2,n.sync();case 2:return s=n.workbook.worksheets.add("kCERT_Analysis_Report"),(l=function(e,n){var t=s.getRange(e);return t.values=[[n]],t})("A".concat(c=1),"kCERT - Formula Analysis Report"),s.getRange("A".concat(c)).format.font.bold=!0,s.getRange("A".concat(c)).format.font.size=16,l("A".concat(c+=2),"Generated: ".concat((new Date).toLocaleString())),l("A".concat(c+=2),"Summary Statistics"),s.getRange("A".concat(c)).format.font.bold=!0,c++,l("A".concat(c),"Total Worksheets:"),l("B".concat(c),be.totalWorksheets),c++,l("A".concat(c),"Total Formulas:"),l("B".concat(c),be.totalFormulas),c++,l("A".concat(c),"Unique Formulas:"),l("B".concat(c),be.uniqueFormulas),c++,l("A".concat(c),"Total Hard-coded Values:"),l("B".concat(c),be.totalHardCodedValues),c++,l("A".concat(c),"Cell Count Analysis"),s.getRange("A".concat(c)).format.font.bold=!0,c++,l("A".concat(c),"Total Cells:"),l("B".concat(c),be.totalCells),c++,l("A".concat(c),"Cells with Formulas:"),l("B".concat(c),be.totalCellsWithFormulas),c++,l("A".concat(c),"Cells with Values:"),l("B".concat(c),be.totalCellsWithValues),c++,l("A".concat(c),"Empty Cells:"),l("B".concat(c),be.totalCells-be.totalCellsWithFormulas-be.totalCellsWithValues),c++,l("A".concat(c),"Hard-coded Values Analysis"),s.getRange("A".concat(c)).format.font.bold=!0,c++,l("A".concat(c),"High Severity:"),l("B".concat(c),(null===(t=be.highSeverityValues)||void 0===t?void 0:t.length)||0),c++,l("A".concat(c),"Medium Severity:"),l("B".concat(c),(null===(r=be.mediumSeverityValues)||void 0===r?void 0:r.length)||0),c++,l("A".concat(c),"Low Severity:"),l("B".concat(c),(null===(o=be.lowSeverityValues)||void 0===o?void 0:o.length)||0),c++,l("A".concat(c),"Info Severity:"),l("B".concat(c),(null===(a=be.infoSeverityValues)||void 0===a?void 0:a.length)||0),c++,l("A".concat(c),"Worksheet Details"),s.getRange("A".concat(c)).format.font.bold=!0,c++,be.worksheets.forEach(function(e){var n;l("A".concat(c),e.name),l("B".concat(c),e.totalFormulas),l("C".concat(c),e.uniqueFormulas),l("D".concat(c),e.cellCountAnalysis.totalCells),l("E".concat(c),e.formulaComplexity),l("F".concat(c),(null===(n=e.hardCodedValueAnalysis)||void 0===n?void 0:n.totalHardCodedValues)||0),c++}),e.n=3,n.sync();case 3:We("Analysis results exported to new worksheet.","success");case 4:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,t=e.v,console.error("Error exporting results:",t),n=Ge(t),We("Error exporting results: ".concat(n),"error");case 4:return e.a(2)}},e,null,[[1,3]])})),Le.apply(this,arguments)}function Oe(){return Ne.apply(this,arguments)}function Ne(){return Ne=ye(le().m(function e(){var n,t;return le().w(function(e){for(;;)switch(e.n){case 0:return e.p=0,Me(!0),We("Generating audit trail...","info"),e.n=1,Excel.run(function(){var e=ye(le().m(function e(n){var t,r;return le().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,K.generateAuditTrail(n);case 1:return t=e.v,e.n=2,n.sync();case 2:r=t.join("\n"),We("Audit Trail generated. Total lines: ".concat(t.length),"success"),alert(r);case 3:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error generating audit trail:",t),n=Ge(t),We("Error generating audit trail: ".concat(n),"error");case 3:return e.p=3,Me(!1),e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])})),Ne.apply(this,arguments)}function Me(e){var n=document.getElementById("loadingIndicator");n&&(n.style.display=e?"block":"none")}function Pe(){var e=document.getElementById("mapSheetChecklist");if(!e)return[];var n=[];return e.querySelectorAll('input[type="checkbox"]').forEach(function(e){var t=e;t.checked&&n.push(t.value)}),n}function Be(e){var n=document.getElementById("mapSheetChecklist");n&&n.querySelectorAll('input[type="checkbox"]').forEach(function(n){n.checked=e})}function De(){return Ve.apply(this,arguments)}function Ve(){return Ve=ye(le().m(function e(){var n,t;return le().w(function(e){for(;;)switch(e.n){case 0:if(e.p=0,Me(!0),We("Generating worksheet maps...","info"),Je([]),0!==(n=Pe()).length){e.n=1;break}return We("Please select at least one worksheet to map.","warning"),Je([]),e.a(2);case 1:return e.n=2,Excel.run(function(){var e=ye(le().m(function e(t){var r,o,a,i,s,l,c,u,d,p;return le().w(function(e){for(;;)switch(e.n){case 0:return r=t.workbook,(o=r.worksheets).load("items/name"),e.n=1,t.sync();case 1:if(a=new Set(["kCERT_Analysis_Report"]),0!==(i=o.items.filter(function(e){return n.includes(e.name)&&!a.has(e.name)})).length){e.n=2;break}return We("No worksheets selected for mapping.","warning"),e.a(2);case 2:ve||(ve=new ae({includeHidden:!0})),s=[],l=se(i),e.p=3,l.s();case 4:if((c=l.n()).done){e.n=9;break}return u=c.value,We('Mapping worksheet "'.concat(u.name,'"...'),"info"),e.n=5,ve.generate(t,u,function(e){We(e,"info")});case 5:if(!(d=e.v).skipped){e.n=6;break}return We("Skipping ".concat(u.name,": ").concat(d.skipReason),"warning"),s.push("".concat(u.name,": skipped (").concat(d.skipReason,")")),e.a(3,8);case 6:return e.n=7,He(t,u.name,d);case 7:s.push("".concat(u.name,": generated (").concat(Se(d.rowCount),"×").concat(Se(d.columnCount),")"));case 8:e.n=4;break;case 9:e.n=11;break;case 10:e.p=10,p=e.v,l.e(p);case 11:return e.p=11,l.f(),e.f(11);case 12:We("Worksheet maps generated successfully.","success"),Je(s);case 13:return e.a(2)}},e,null,[[3,10,11,12]])}));return function(n){return e.apply(this,arguments)}}());case 2:return e.n=3,Xe();case 3:e.n=5;break;case 4:e.p=4,t=e.v,console.error("Error generating maps",t),We("Error generating maps: ".concat(Ge(t)),"error"),Je([]);case 5:return e.p=5,Me(!1),e.f(5);case 6:return e.a(2)}},e,null,[[0,4,5,6]])})),Ve.apply(this,arguments)}function He(e,n,t){return _e.apply(this,arguments)}function _e(){return(_e=ye(le().m(function e(n,t,r){var o,a,i,s,l,c,u,d,p,f,m,h,g,y;return le().w(function(e){for(;;)switch(e.n){case 0:return o=n.workbook,a=ze(t),(i=o.worksheets.getItemOrNullObject(a)).load("isNullObject"),e.n=1,n.sync();case 1:if(i.isNullObject){e.n=2;break}return i.delete(),e.n=2,n.sync();case 2:if(s=o.worksheets.add(a),l=r.rowCount,c=r.columnCount,u=r.symbols,d=r.counts,p=r.arrayAreas,f=r.usedRangeAddress,0!==l&&0!==c){e.n=4;break}return s.getRange("A1").values=[["No used range detected for ".concat(t,".")]],s.getRange("A2").values=[["Reason: ".concat(null!==(m=r.skipReason)&&void 0!==m?m:"unknown")]],e.n=3,n.sync();case 3:case 5:return e.a(2);case 4:return(h=s.getRangeByIndexes(0,0,l,c)).values=u,h.format.font.name="Consolas",h.format.font.size=10,h.format.columnWidth=12,h.format.rowHeight=18,h.format.horizontalAlignment="Center",h.format.verticalAlignment="Center",Ue(h,u),p.forEach(function(e){var n=s.getRangeByIndexes(e.top,e.left,e.bottom-e.top+1,e.right-e.left+1);n.format.borders.getItem("EdgeTop").style="Continuous",n.format.borders.getItem("EdgeTop").weight="Thick",n.format.borders.getItem("EdgeBottom").style="Continuous",n.format.borders.getItem("EdgeBottom").weight="Thick",n.format.borders.getItem("EdgeLeft").style="Continuous",n.format.borders.getItem("EdgeLeft").weight="Thick",n.format.borders.getItem("EdgeRight").style="Continuous",n.format.borders.getItem("EdgeRight").weight="Thick"}),g=l+2,(y=s.getRange("A".concat(g,":D").concat(g+8))).values=qe(t,f,d,r.anomalies),y.format.font.bold=!0,y.format.columnWidth=30,e.n=5,n.sync()}},e)}))).apply(this,arguments)}function ze(e){var n="".concat(e,"_maps").substring(0,31);return n===e?"".concat(e,"_maps").substring(0,31):n}function Ue(e,n){var t=n.length;if(0!==t){for(var r=n[0].length,o=Array.from({length:t},function(){return new Array(r).fill("")}),a=0;a<t;a++)for(var i=0;i<r;i++){var s=n[a][i];o[a][i]=je(s)}e.format.fill.color="white",e.format.font.color="#1b1a19";for(var l=0;l<t;l++)for(var c=0;c<r;c++){var u=o[l][c];u&&"#FFFFFF"!==u&&(e.getCell(l,c).format.fill.color=u)}}}function je(e){switch(e){case"F":return"#7030A0";case"<":return"#4472C4";case"^":return"#5B9BD5";case"+":return"#2F5597";case"L":return"#D9D9D9";case"N":return"#FFC000";case"A":return"#9E480E";default:return"#FFFFFF"}}function qe(e,n,t,r){return[["Worksheet",e,"Used Range",n],["Legend","F: Unique formula (".concat(t.F,")"),"^: Copy from above (".concat(t["^"],")"),"+: Copy both (".concat(t["+"],")")],["","<: Copy from left (".concat(t["<"],")"),"L: Label (".concat(t.L,")"),"N: Numeric input (".concat(t.N,")")],["","A: Array formula (".concat(t.A,")"),"",""],["Anomalies","Direction switches: ".concat(r.changeOfDirection),"Horizontal breaks: ".concat(r.horizontalBreaks),"Vertical breaks: ".concat(r.verticalBreaks)]]}function We(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=function(){var e=document.getElementById("statusMessages");if(e)return e;var n=document.createElement("div");return n.id="statusMessages",document.body.appendChild(n),n}();t.textContent=e,t.className="status-message ".concat(n),t.style.display="block"}function Ge(e){return e.message?e.message:e.error?e.error.message:String(e)}function Ke(e){return e.replace(/[&<>"']/g,function(e){return Ce[e]})}function Xe(){return Ye.apply(this,arguments)}function Ye(){return Ye=ye(le().m(function e(){var n,t;return le().w(function(e){for(;;)switch(e.n){case 0:if(n=document.getElementById("mapSheetChecklist")){e.n=1;break}return e.a(2);case 1:return n.innerHTML='<div class="map-sheet-placeholder">Loading worksheets...</div>',e.p=2,e.n=3,Excel.run(function(){var e=ye(le().m(function e(n){var t;return le().w(function(e){for(;;)switch(e.n){case 0:return(t=n.workbook.worksheets).load("items/name"),e.n=1,n.sync();case 1:$e(t.items.map(function(e){return e.name}).filter(function(e){return"kCERT_Analysis_Report"!==e&&!e.endsWith("_maps")}));case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 3:e.n=5;break;case 4:e.p=4,t=e.v,console.error("Failed to refresh worksheet list",t),n.innerHTML='<div class="map-sheet-placeholder">Unable to load worksheets</div>';case 5:return e.a(2)}},e,null,[[2,4]])})),Ye.apply(this,arguments)}function $e(e){var n=document.getElementById("mapSheetChecklist");if(n)if(0!==e.length){var t=document.createDocumentFragment();e.forEach(function(e){var n=document.createElement("label");n.className="map-sheet-item";var r=document.createElement("input");r.type="checkbox",r.value=e,r.checked=!0;var o=document.createElement("span");o.textContent=e,n.appendChild(r),n.appendChild(o),t.appendChild(n)}),n.innerHTML="",n.appendChild(t)}else n.innerHTML='<div class="map-sheet-placeholder">No worksheets available</div>'}function Je(e){var n=document.getElementById("mapRunSummary");if(n){if(!e||0===e.length)return n.style.display="none",void(n.innerHTML="");n.style.display="block",n.innerHTML='\n        <strong>Recent map run:</strong>\n        <ul class="map-summary-list">\n            '.concat(e.map(function(e){return"<li>".concat(Ke(e),"</li>")}).join(""),"\n        </ul>\n    ")}}function Qe(e){var n,t=document.getElementById("summaryOverview");if(t){t.hidden=!1;var r=e.uniqueSummary.ufCount;xe=null!==(n=e.uniqueSummary.minutesPerFormula)&&void 0!==n?n:xe;var o=Math.round(r*xe),a=o/60;Ae("summaryUniqueCount",Se(r)),Ae("summaryEstimatedMinutes",Se(o)),Ae("summaryEstimatedHours",a.toFixed(1)),Ae("summaryWorksheetsScanned",Se(e.totalWorksheets));var i=document.getElementById("minutesPerFormula");i&&(i.value=String(xe)),function(e){var n=document.getElementById("workbookStats");if(n){n.hidden=!1;var t=e.totalFormulas,r=e.uniqueFormulas,o=e.totalWorksheets,a=o>0?(t/o).toFixed(0):"0",i=e.worksheets.reduce(function(e,n){var t=n.formulaComplexity||"Low";return e[t]=(e[t]||0)+1,e},{});Ae("wbTotalFormulas",Se(t)),Ae("wbUniqueFormulas",Se(r)),Ae("wbAvgFormulasPerSheet",Se(a)),Ae("wbComplexityHigh",Se(i.High||0)),Ae("wbComplexityMedium",Se(i.Medium||0)),Ae("wbComplexityLow",Se(i.Low||0))}}(e),function(e){var n=document.getElementById("sheetBreakdown"),t=document.getElementById("sheetBreakdownContent");if(n&&t)if(0!==e.worksheets.length){n.hidden=!1,t.innerHTML="";var r=document.createElement("table");r.className="sheet-breakdown-table";var o=document.createElement("thead");o.innerHTML="\n        <tr>\n            <th>Sheet Name</th>\n            <th>Formulas</th>\n            <th>Unique</th>\n            <th>Cells</th>\n            <th>Formula %</th>\n            <th>Hard-coded</th>\n            <th>Complexity</th>\n            <th>Ask GPT</th>\n        </tr>\n    ",r.appendChild(o);var a=document.createElement("tbody");e.worksheets.forEach(function(e){var n,t,r=(null===(n=e.cellCountAnalysis)||void 0===n?void 0:n.totalCells)||e.totalCells||0,o=e.totalFormulas||0,i=r>0?(o/r*100).toFixed(1):"0.0",s=(null===(t=e.hardCodedValueAnalysis)||void 0===t?void 0:t.totalHardCodedValues)||0,l=e.formulaComplexity||"Low",c=document.createElement("tr"),u=document.createElement("td");u.className="ask-gpt-cell";var d=document.createElement("button");d.type="button",d.className="ask-gpt-button",d.textContent="Ask GPT",d.title="Get explanation of this sheet",d.addEventListener("click",function(){return function(e){return kn.apply(this,arguments)}(e)}),u.appendChild(d),pn(d),c.innerHTML='\n            <td class="sheet-name-cell">'.concat(Ke(e.name),'</td>\n            <td class="number-cell">').concat(Se(o),'</td>\n            <td class="number-cell">').concat(Se(e.uniqueFormulas||0),'</td>\n            <td class="number-cell">').concat(Se(r),'</td>\n            <td class="number-cell">').concat(i,'%</td>\n            <td class="number-cell">').concat(Se(s),'</td>\n            <td class="complexity-cell complexity-').concat(Ke(l.toLowerCase()),'">').concat(Ke(l),"</td>\n        "),c.appendChild(u),a.appendChild(c)}),r.appendChild(a),t.appendChild(r),fn()}else n.hidden=!0}(e),fn()}}var Ze=new Map;function en(e){var n,t=document.getElementById("uniqueFormulaTableBody");if(t){Ze.clear(),t.innerHTML="";var r=we.showReviewedOnly||we.searchTerm.length>0,o=[];if(e.worksheets.forEach(function(e){e.uniqueFormulasList.forEach(function(n){if(!we.showReviewedOnly){if(we.searchTerm){var r=we.searchTerm;if(!"".concat(n.ufIndicator," ").concat(n.normalizedFormula," ").concat(e.name).toLowerCase().includes(r))return}var a=document.createElement("tr");a.setAttribute("data-ufi",n.ufIndicator),a.setAttribute("data-row-type","ufi"),a.setAttribute("data-worksheet",e.name),a.setAttribute("data-cell-address",n.cells[0]||""),a.setAttribute("data-count",n.count.toString()),a.setAttribute("data-fscore",n.fScore.toString()),a.setAttribute("data-complexity",n.complexity);var i=document.createElement("td"),s=document.createElement("button");s.type="button",s.className="add-fin-button",s.textContent="+",s.title="Add FIN (Findings/Issues/Notes)",s.addEventListener("click",function(){return function(e,n,t){var r=(Ze.get(e)||[]).length+1,o={ufi:e,finIndex:r};Ze.has(e)||Ze.set(e,[]),Ze.get(e).push(o);var a=tn(e,r,n);n.insertBefore(a,t.nextSibling),rn(e,n)}(n.ufIndicator,t,a)}),i.appendChild(s);var l=document.createElement("span");l.textContent=n.ufIndicator,i.appendChild(l);var c=document.createElement("td");c.textContent="";var u=document.createElement("td");u.textContent=e.name;var d=document.createElement("td");d.className="formula-cell clickable-formula",d.textContent=n.exampleFormula,d.title="Click to navigate to ".concat(n.cells[0]||"cell"),d.addEventListener("click",function(){return function(e,n){return Tn.apply(this,arguments)}(e.name,n.cells[0])});var p=document.createElement("td");p.className="formula-cell",p.textContent=n.normalizedFormula;var f=document.createElement("td");f.textContent=Se(n.count);var m=document.createElement("td");m.className="complexity-fscore-cell";var h=document.createElement("div");h.className="complexity-label complexity-".concat(n.complexity.toLowerCase()),h.textContent=n.complexity;var g=document.createElement("div");g.className="fscore-label",g.textContent="F-Score: ".concat(Se(n.fScore)),m.appendChild(h),m.appendChild(g);var y=document.createElement("td"),b=document.createElement("select");b.className="priority-dropdown",b.setAttribute("data-field","priority"),b.setAttribute("data-ufi",n.ufIndicator),b.disabled=!0,b.innerHTML='\n                <option value="">--</option>\n                <option value="High">High</option>\n                <option value="Medium">Medium</option>\n                <option value="Low">Low</option>\n            ',b.addEventListener("change",function(e){var n=e.target;n.setAttribute("data-selected",n.value),n.value?(n.style.backgroundColor="High"===n.value?"#d13438":"Medium"===n.value?"#ffaa44":"#107c10",n.style.color="white"):(n.style.backgroundColor="",n.style.color="")}),y.appendChild(b),y.classList.add("ufi-priority-status-cell");var v=document.createElement("td");v.setAttribute("data-field","status"),v.setAttribute("data-ufi",n.ufIndicator),v.classList.add("ufi-priority-status-cell");var x=document.createElement("td");x.contentEditable="true",x.setAttribute("data-field","comment");var w=document.createElement("td");w.contentEditable="true",w.setAttribute("data-field","clientResponse");var k=document.createElement("td"),E=document.createElement("button");E.type="button",E.className="ask-gpt-button",E.textContent="Ask GPT",E.title="Get explanation of this formula",E.addEventListener("click",function(){return function(e,n){return gn.apply(this,arguments)}(n.exampleFormula,n.ufIndicator)}),k.appendChild(E),pn(E),a.appendChild(i),a.appendChild(c),a.appendChild(u),a.appendChild(d),a.appendChild(p),a.appendChild(f),a.appendChild(m),a.appendChild(y),a.appendChild(v),a.appendChild(x),a.appendChild(w),a.appendChild(k),o.push(a);var C=Ze.get(n.ufIndicator)||[];C.forEach(function(e){var r=tn(n.ufIndicator,e.finIndex,t);o.push(r)}),C.length>0?(b.disabled=!1,v.contentEditable="true",y.classList.remove("ufi-priority-status-greyed"),v.classList.remove("ufi-priority-status-greyed")):(b.disabled=!0,v.removeAttribute("contenteditable"),y.classList.add("ufi-priority-status-greyed"),v.classList.add("ufi-priority-status-greyed"))}})}),!o.length&&r){var a=document.createElement("tr");return a.innerHTML='<td colspan="13" class="listing-empty">No formulas match current filters.</td>',void t.appendChild(a)}var i=new Map;o.filter(function(e){return"ufi"===e.getAttribute("data-row-type")}).forEach(function(e){var n=e.getAttribute("data-worksheet")||"";i.has(n)||i.set(n,[]),i.get(n).push(e)});var s=Array.from(i.keys()).sort();s.forEach(function(e){i.get(e).sort(function(e,n){var t=Number(e.getAttribute("data-fscore")||e.children[6].textContent||"0");return Number(n.getAttribute("data-fscore")||n.children[6].textContent||"0")-t})}),s.forEach(function(e,n){if(n>0){var r=document.createElement("tr");r.className="sheet-separator-row",r.innerHTML='<td colspan="13" class="sheet-separator-cell"></td>',t.appendChild(r)}var a=document.createElement("tr");a.className="sheet-header-row";var s=document.createElement("td");s.colSpan=13,s.className="sheet-header-cell",s.textContent="Sheet: ".concat(e),a.appendChild(s),t.appendChild(a),i.get(e).forEach(function(e){t.appendChild(e);var n=e.getAttribute("data-ufi");n&&o.filter(function(e){return"fin"===e.getAttribute("data-row-type")&&e.getAttribute("data-ufi")===n}).forEach(function(e){return t.appendChild(e)})})}),function(e){var n=e.closest("table");n&&n.querySelectorAll('th[data-sortable="true"]').forEach(function(t){t.addEventListener("click",function(){var r,o=t.getAttribute("data-sort-key");o&&((null===(r=nn)||void 0===r?void 0:r.key)===o?nn.direction="asc"===nn.direction?"desc":"asc":nn={key:o,direction:"asc"},function(e,n,t){Array.from(e.querySelectorAll("tr.sheet-header-row")),Array.from(e.querySelectorAll("tr.sheet-separator-row"));var r=new Map;Array.from(e.querySelectorAll('tr[data-row-type="fin"]')).forEach(function(e){var n=e.getAttribute("data-ufi");n&&(r.has(n)||r.set(n,[]),r.get(n).push(e))});var o=new Map;Array.from(e.querySelectorAll('tr[data-row-type="ufi"]')).forEach(function(e){var n=e.getAttribute("data-worksheet")||"";o.has(n)||o.set(n,[]),o.get(n).push(e)}),o.forEach(function(e,r){e.sort(function(e,r){var o,a;switch(n){case"count":o=Number(e.getAttribute("data-count")||e.children[5].textContent||"0"),a=Number(r.getAttribute("data-count")||r.children[5].textContent||"0");break;case"fscore":case"complexity":o=Number(e.getAttribute("data-fscore")||"0"),a=Number(r.getAttribute("data-fscore")||"0");break;case"sheet":o=(e.children[2].textContent||"").toLowerCase(),a=(r.children[2].textContent||"").toLowerCase();break;default:return 0}return"number"==typeof o&&"number"==typeof a?"asc"===t?o-a:a-o:o<a?"asc"===t?-1:1:o>a?"asc"===t?1:-1:0})});var a=Array.from(o.keys()).sort();"sheet"===n&&a.sort(function(e,n){return"asc"===t?e.localeCompare(n):n.localeCompare(e)}),e.innerHTML="",a.forEach(function(n,t){if(t>0){var a=document.createElement("tr");a.className="sheet-separator-row",a.innerHTML='<td colspan="13" class="sheet-separator-cell"></td>',e.appendChild(a)}var i=document.createElement("tr");i.className="sheet-header-row";var s=document.createElement("td");s.colSpan=13,s.className="sheet-header-cell",s.textContent="Sheet: ".concat(n),i.appendChild(s),e.appendChild(i),o.get(n).forEach(function(n){e.appendChild(n);var t=n.getAttribute("data-ufi");t&&(r.get(t)||[]).forEach(function(n){return e.appendChild(n)})})})}(e,o,nn.direction),function(e){nn&&e.querySelectorAll('th[data-sortable="true"]').forEach(function(e){e.classList.remove("sort-asc","sort-desc"),e.getAttribute("data-sort-key")===nn.key&&e.classList.add("sort-".concat(nn.direction))})}(n))})})}(t),function(){var e=document.getElementById("uniqueFormulaTable"),n=document.getElementById("tableColgroup");if(e&&n){n.innerHTML="";for(var t=e.querySelectorAll("thead th"),r=t.length,o=[],a=[80,100,120,250,250,70,80,100,120,100,150,150,100],i=[120,150,200,400,400,100,120,150,150,150,300,300,150],s=0;s<r;s++){var l=0,c=8*(t[s].textContent||"").length+32;l=Math.max(l,c);for(var u=e.querySelectorAll("tbody td:nth-child(".concat(s+1,")")),d=Math.min(10,u.length),p=0;p<d;p++){var f=u[p],m=f.textContent||"";if(f.classList.contains("formula-cell")){var h=Math.min(7*m.length+32,400);l=Math.max(l,h)}else{var g=Math.min(8*m.length+32,300);l=Math.max(l,g)}}var y=Math.max(a[s]||80,Math.min(l,i[s]||300));o.push(y);var b=document.createElement("col");b.style.width="".concat(y,"px"),n.appendChild(b)}for(var v=function(){var n=o[x];e.querySelectorAll("th:nth-child(".concat(x+1,"), td:nth-child(").concat(x+1,")")).forEach(function(e){var t=e;t.style.width="".concat(n,"px"),t.style.minWidth="".concat(n,"px")})},x=0;x<r;x++)v()}}(),(n=document.getElementById("uniqueFormulaTable"))&&(n.querySelectorAll(".column-resize-handle").forEach(function(e){return e.remove()}),n.querySelectorAll("thead th").forEach(function(e,t){var r=!1,o=0,a=0,i=document.createElement("div");i.className="column-resize-handle",i.style.cssText="position:absolute;right:0;top:0;bottom:0;width:4px;cursor:col-resize;z-index:10;",e.appendChild(i),i.addEventListener("mousedown",function(n){r=!0,o=n.clientX,a=e.offsetWidth,document.body.style.cursor="col-resize",document.body.style.userSelect="none",n.preventDefault(),n.stopPropagation()});var s=function(i){if(r){var s=i.clientX-o,l=Math.max(40,a+s),c=e,u=t;c.style.width="".concat(l,"px"),c.style.minWidth="".concat(l,"px"),c.style.maxWidth="".concat(l,"px");var d=n.querySelectorAll("col");d.length>u&&(d[u].style.width="".concat(l,"px")),n.querySelectorAll("tbody td:nth-child(".concat(u+1,"), thead th:nth-child(").concat(u+1,")")).forEach(function(e){var n=e;n.style.width="".concat(l,"px"),n.style.minWidth="".concat(l,"px")})}};document.addEventListener("mousemove",s);var l=function(){r&&(r=!1,document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l))};document.addEventListener("mouseup",l)}))}}var nn=null;function tn(e,n,t,r){var o=document.createElement("tr");o.setAttribute("data-ufi",e),o.setAttribute("data-row-type","fin"),o.setAttribute("data-fin-index",n.toString()),o.className="fin-subrow";var a=document.createElement("td");a.textContent="";var i=document.createElement("td");i.className="fin-cell";var s=document.createElement("span");s.textContent="FIN-".concat(n.toString().padStart(4,"0")),i.appendChild(s);var l=document.createElement("button");l.type="button",l.className="delete-fin-button",l.textContent="×",l.title="Delete this FIN",l.addEventListener("click",function(){return function(e,n,t,r){var o=(Ze.get(e)||[]).filter(function(e){return e.finIndex!==n});Ze.set(e,o),t.remove(),rn(e,r)}(e,n,o,t)}),i.appendChild(l);var c=document.createElement("td");c.textContent="";var u=document.createElement("td");u.textContent="";var d=document.createElement("td");d.textContent="";var p=document.createElement("td");p.textContent="";var f=document.createElement("td");f.textContent="";var m=document.createElement("td"),h=document.createElement("select");h.className="priority-dropdown",h.setAttribute("data-field","priority"),h.setAttribute("data-ufi",e),h.setAttribute("data-fin",n.toString()),h.innerHTML='\n        <option value="">--</option>\n        <option value="High">High</option>\n        <option value="Medium">Medium</option>\n        <option value="Low">Low</option>\n    ',h.addEventListener("change",function(n){var r=n.target;r.setAttribute("data-selected",r.value),r.value?(r.style.backgroundColor="High"===r.value?"#d13438":"Medium"===r.value?"#ffaa44":"#107c10",r.style.color="white"):(r.style.backgroundColor="",r.style.color=""),rn(e,t)}),m.appendChild(h);var g=document.createElement("td");g.contentEditable="true",g.setAttribute("data-field","status"),g.setAttribute("data-ufi",e),g.setAttribute("data-fin",n.toString());var y=document.createElement("td");y.contentEditable="true",y.setAttribute("data-field","comment"),y.setAttribute("data-ufi",e),y.setAttribute("data-fin",n.toString());var b=document.createElement("td");b.contentEditable="true",b.setAttribute("data-field","clientResponse"),b.setAttribute("data-ufi",e),b.setAttribute("data-fin",n.toString());var v=document.createElement("td");return v.textContent="",o.appendChild(a),o.appendChild(i),o.appendChild(c),o.appendChild(u),o.appendChild(d),o.appendChild(p),o.appendChild(f),o.appendChild(m),o.appendChild(g),o.appendChild(y),o.appendChild(b),o.appendChild(v),o}function rn(e,n){var t=n.querySelector('tr[data-row-type="ufi"][data-ufi="'.concat(e,'"]'));if(t){var r=t.querySelectorAll("td");if(!(r.length<10)){var o=r[8],a=r[9],i=o.querySelector("select");n.querySelectorAll('tr[data-row-type="fin"][data-ufi="'.concat(e,'"]')).length>0?(i&&(i.disabled=!1),a.contentEditable="true",o.classList.remove("ufi-priority-status-greyed"),a.classList.remove("ufi-priority-status-greyed")):(i&&(i.disabled=!0),a.removeAttribute("contenteditable"),o.classList.add("ufi-priority-status-greyed"),a.classList.add("ufi-priority-status-greyed"))}}}var on="kCERT_gpt_settings";function an(){try{var e=localStorage.getItem(on);if(e)return JSON.parse(e)}catch(e){console.error("Error reading GPT settings:",e)}return null}function sn(e){try{localStorage.setItem(on,JSON.stringify(e))}catch(e){console.error("Error saving GPT settings:",e)}}function ln(){var e=document.getElementById("gptSettingsModal"),n=document.getElementById("bearerToken"),t=document.getElementById("engagementCode"),r=document.getElementById("gptSettingsStatus");if(e&&n&&t&&r){var o=an();o?(n.value=o.bearerToken||"",t.value=o.engagementCode||""):(n.value="",t.value=""),r.textContent="",r.className="settings-status",e.style.display="flex";var a=function(n){n.target===e&&(cn(),e.removeEventListener("click",a))};e.addEventListener("click",a)}}function cn(){var e=document.getElementById("gptSettingsModal");e&&(e.style.display="none")}function un(){return dn.apply(this,arguments)}function dn(){return(dn=ye(le().m(function e(){var n,t,r,o,a,i,s;return le().w(function(e){for(;;)switch(e.n){case 0:if(n=document.getElementById("bearerToken"),t=document.getElementById("engagementCode"),r=document.getElementById("gptSettingsStatus"),n&&t&&r){e.n=1;break}return e.a(2);case 1:if(o=n.value.trim(),a=t.value.trim(),o&&a){e.n=2;break}return r.textContent="Please enter both Bearer Token and Engagement Code.",r.className="settings-status error",e.a(2);case 2:return r.textContent="Validating credentials...",r.className="settings-status info",e.p=3,e.n=4,mn(o,a,"Test validation");case 4:(i=e.v)&&!i.error?(sn({bearerToken:o,engagementCode:a,isValidated:!0}),r.textContent="Settings saved and validated successfully!",r.className="settings-status success",fn(),setTimeout(function(){cn()},1500)):(r.textContent="Validation failed: ".concat((null==i?void 0:i.error)||"Unknown error"),r.className="settings-status error"),e.n=6;break;case 5:e.p=5,s=e.v,r.textContent="Validation failed: ".concat(s.message||"Unknown error"),r.className="settings-status error";case 6:return e.a(2)}},e,null,[[3,5]])}))).apply(this,arguments)}function pn(e){var n=an();n&&n.isValidated?(e.disabled=!1,e.style.opacity="1",e.style.cursor="pointer"):(e.disabled=!0,e.style.opacity="0.6",e.style.cursor="not-allowed",e.title="Get explanation of this formula (Configure GPT Settings first)")}function fn(){document.querySelectorAll(".ask-gpt-button, .ask-gpt-workbook-button").forEach(function(e){return pn(e)})}function mn(e,n,t){return hn.apply(this,arguments)}function hn(){return(hn=ye(le().m(function e(n,t,r){var o,a,i,s,l,c,u,d,p,f,m,h,g,y;return le().w(function(e){for(;;)switch(e.n){case 0:return o="http://localhost:3001/api/gpt",a=n.trim(),i=t.trim(),s=r.trim(),l=s.substring(0,25e3),c="Explain this Excel formula in plain English without any formatting. Formula: ".concat(l).trim(),u={"Content-Type":"application/json",Accept:"*/*",Authorization:"Bearer ".concat(a)},d={engagementCode:i,modelName:"GPT 4o Omni",provider:"AzureOpenAI",providerModelName:"gpt-4o",parameters:{max_tokens:1024,frequency_penalty:2,presence_penalty:2,temperature:.9,top_p:1},prompt:c,messages:[{role:"system",content:"You are a helpful assistant that explains Excel formulas in plain English."},{role:"user",content:c}]},e.p=1,console.log("Making GPT API request:",{url:o,headers:de(de({},u),{},{Authorization:"Bearer ***"}),body:d}),p=de(de({},d),{},{bearerToken:a}),f={"Content-Type":"application/json"},e.n=2,fetch(o,{method:"POST",headers:f,body:JSON.stringify(p),mode:"cors",credentials:"omit"});case 2:if(401!==(m=e.v).status){e.n=3;break}return e.a(2,{error:"Authentication failed. Please check your bearer token."});case 3:if(m.ok){e.n=5;break}return e.n=4,m.text().catch(function(){return""});case 4:return h=e.v,e.a(2,{error:"Request failed with status ".concat(m.status,". ").concat(h?"Response: ".concat(h.substring(0,200)):"")});case 5:return e.n=6,m.json();case 6:return g=e.v,console.log("GPT API Response:",JSON.stringify(g,null,2)),e.a(2,g);case 7:if(e.p=7,y=e.v,console.error("GPT API error:",y),"TypeError"!==y.name||!y.message.includes("Failed to fetch")){e.n=8;break}return console.error("CORS or Network Error Details:",{url:o,method:"POST",headers:u,error:y}),e.a(2,{error:"Failed to connect to GPT API. This is likely a CORS (Cross-Origin Resource Sharing) issue. The API server needs to allow requests from this Excel Add-in domain. Please contact IT support to: 1) Configure CORS headers on the API to allow requests from your add-in domain, or 2) Set up a proxy service to handle the API calls. Check the browser console (F12) for more details."});case 8:return e.a(2,{error:y.message||"Failed to connect to GPT API"})}},e,null,[[1,7]])}))).apply(this,arguments)}function gn(){return(gn=ye(le().m(function e(n,t){var r,o,a,i,s,l,c,u,d,p,f,m,h;return le().w(function(e){for(;;)switch(e.n){case 0:if((r=an())&&r.isValidated){e.n=1;break}return We("Please configure GPT settings first.","warning"),ln(),e.a(2);case 1:if(o=document.getElementById("gptResponseModal"),a=document.getElementById("gptResponseContent"),i=document.getElementById("gptResponseError"),o&&a&&i){e.n=2;break}return e.a(2);case 2:return o.style.display="flex",a.textContent="Getting explanation...",i.style.display="none",s=function(e){e.target===o&&(o.style.display="none",o.removeEventListener("click",s))},o.addEventListener("click",s),e.p=3,e.n=4,mn(r.bearerToken,r.engagementCode,n);case 4:if((l=e.v).error)i.textContent=l.error,i.style.display="block",a.textContent="";else if(console.log("Parsing GPT response. Response type:",ie(l)),console.log("Response keys:",Object.keys(l||{})),console.log("Full response object:",l),c="",l.choices&&Array.isArray(l.choices)&&l.choices.length>0&&((u=l.choices[0]).message&&"string"==typeof u.message?(c=u.message,console.log("Found explanation in response.choices[0].message (string)")):u.message&&u.message.content?(c=u.message.content,console.log("Found explanation in response.choices[0].message.content")):u.text?(c=u.text,console.log("Found explanation in response.choices[0].text")):u.content&&(c=u.content,console.log("Found explanation in response.choices[0].content"))),c||(l.response?(c="string"==typeof l.response?l.response:JSON.stringify(l.response),console.log("Found explanation in response.response")):l.data&&(c="string"==typeof l.data?l.data:JSON.stringify(l.data),console.log("Found explanation in response.data"))),c||(l.text?(c=l.text,console.log("Found explanation in response.text")):l.content?(c=l.content,console.log("Found explanation in response.content")):l.message?(c=l.message,console.log("Found explanation in response.message")):l.result?(c="string"==typeof l.result?l.result:JSON.stringify(l.result),console.log("Found explanation in response.result")):l.output&&(c="string"==typeof l.output?l.output:JSON.stringify(l.output),console.log("Found explanation in response.output"))),c||"string"!=typeof l||(c=l,console.log("Response is a string")),!c&&l.message&&("string"==typeof(d=l.message)?c=d:d.content?c=d.content:d.text&&(c=d.text)),c&&c.trim()){p=c.trim();try{"string"==typeof(f=JSON.parse(p))?p=f:(f.text||f.content||f.message)&&(p=f.text||f.content||f.message)}catch(e){}a.innerHTML=bn(p),i.style.display="none"}else m=JSON.stringify(l,null,2).substring(0,1e3),i.innerHTML='\n                    <strong>No explanation text found in response.</strong><br><br>\n                    <strong>Response structure:</strong><br>\n                    <pre style="font-size: 11px; overflow: auto; max-height: 200px;">'.concat(Ke(m),"</pre><br>\n                    Please check the browser console (F12) for the full response structure.\n                "),i.style.display="block",a.textContent="",console.error("Could not extract explanation from response:",l);e.n=6;break;case 5:e.p=5,h=e.v,i.textContent="Error: ".concat(h.message||"Failed to get explanation"),i.style.display="block",a.textContent="";case 6:return e.a(2)}},e,null,[[3,5]])}))).apply(this,arguments)}function yn(){var e=document.getElementById("gptResponseModal");if(e){e.style.display="none";var n=e.querySelector(".modal-header h3");n&&(n.textContent="Formula Explanation")}}function bn(e){for(var n=e.trim(),t=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=Ke(n)).replace(/\d+\.\*[^*]*\*/g,"")).replace(/^### (.+)$/gm,"<h3>$1</h3>")).replace(/^## (.+)$/gm,"<h2>$1</h2>")).replace(/^# (.+)$/gm,"<h1>$1</h1>")).replace(/`([^`\n]+?)`/g,"<code>$1</code>")).replace(/\*\*([^*\n]+?)\*\*/g,"<strong>$1</strong>")).replace(/__([^_\n]+?)__/g,"<strong>$1</strong>")).replace(/(^|[^*\s])\*([^*\s\n][^*\n]*?[^*\s\n])\*([^*\s]|$)/g,"$1<em>$2</em>$3")).replace(/(^|[^_\s])_([^_\s\n][^_\n]*?[^_\s\n])_([^_\s]|$)/g,"$1<em>$2</em>$3")).replace(/(:\s*|\n\s*)\*([^*\n]+?)\*/g,"$1<em>$2</em>")).split("\n"),r=[],o=!1,a=null,i=0;i<t.length;i++){var s=t[i],l=s.trim(),c=l.match(/^[-*]\s+(.+)$/),u=l.match(/^\d+\.\s+(.+)$/);c?(o&&"ul"===a||(o&&"ol"===a?r.push("</ol>"):o&&r.push("</ul>"),r.push("<ul>"),o=!0,a="ul"),r.push("<li>"+c[1]+"</li>")):u?(o&&"ol"===a||(o&&"ul"===a?r.push("</ul>"):o&&r.push("</ol>"),r.push("<ol>"),o=!0,a="ol"),r.push("<li>"+u[1]+"</li>")):(o&&("ul"===a?r.push("</ul>"):r.push("</ol>"),o=!1,a=null),(l||s.includes("<"))&&r.push(s))}o&&("ul"===a?r.push("</ul>"):r.push("</ol>"));var d=(n=r.join("\n")).split(/\n\n+/);return(n=(n=(n=(n=d.map(function(e){return(e=e.trim())?e.match(/^<(h[1-6]|ul|ol|li|p|div|code|pre)/)||e.includes("<h")||e.includes("<ul")||e.includes("<ol")||e.includes("<li")?e:"<p>"+e+"</p>":""}).join("\n\n")).replace(/([^>])\n([^<])/g,"$1<br>$2")).replace(/<br>\s*<br>/g,"<br>")).replace(/<p>\s*<\/p>/g,"")).replace(/<p><br><\/p>/g,"")}function vn(e){return xn.apply(this,arguments)}function xn(){return xn=ye(le().m(function e(n){var t,r,o,a;return le().w(function(e){for(;;)switch(e.n){case 0:return o="Sheet Name: ".concat(n.name,"\n"),o+="Total Formulas: ".concat(n.totalFormulas,"\n"),o+="Unique Formulas: ".concat(n.uniqueFormulas,"\n"),o+="Total Cells: ".concat((null===(t=n.cellCountAnalysis)||void 0===t?void 0:t.totalCells)||n.totalCells||0,"\n"),o+="Complexity: ".concat(n.formulaComplexity||"Low","\n"),o+="Hard-coded Values: ".concat((null===(r=n.hardCodedValueAnalysis)||void 0===r?void 0:r.totalHardCodedValues)||0,"\n\n"),e.p=1,e.n=2,Excel.run(function(){var e=ye(le().m(function e(t){var r,a,i,s,l,c,u;return le().w(function(e){for(;;)switch(e.n){case 0:return r=t.workbook.worksheets.getItem(n.name),(a=r.getUsedRange()).load(["address","formulas"]),e.n=1,t.sync();case 1:if(a.formulas){for(o+="Sample Formulas:\n",i=[],s=0;s<a.formulas.length&&i.length<50;s++)for(l=0;l<a.formulas[s].length&&i.length<50;l++)(c=a.formulas[s][l])&&"string"==typeof c&&c.startsWith("=")&&i.push(c);(u=Array.from(new Set(i))).slice(0,30).forEach(function(e,n){o+="".concat(n+1,". ").concat(e.trim(),"\n")}),u.length>30&&(o+="... and ".concat(u.length-30," more unique formulas\n"))}case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,a=e.v,console.warn("Could not gather sheet formulas:",a),n.uniqueFormulasList&&n.uniqueFormulasList.length>0&&(o+="Sample Formulas:\n",n.uniqueFormulasList.slice(0,30).forEach(function(e,n){o+="".concat(n+1,". ").concat(e.formula.trim(),"\n")}));case 4:return e.a(2,o.trim())}},e,null,[[1,3]])})),xn.apply(this,arguments)}function wn(e){var n="Workbook Summary:\n";return n+="Total Worksheets: ".concat(e.totalWorksheets,"\n"),n+="Total Formulas: ".concat(e.totalFormulas,"\n"),n+="Unique Formulas: ".concat(e.uniqueFormulas,"\n"),n+="Total Cells: ".concat(e.totalCells,"\n\n"),n+="Worksheets:\n",e.worksheets.forEach(function(e,t){var r,o;n+="".concat(t+1,". ").concat(e.name,"\n"),n+="   - Formulas: ".concat(e.totalFormulas,", Unique: ").concat(e.uniqueFormulas,"\n"),n+="   - Cells: ".concat((null===(r=e.cellCountAnalysis)||void 0===r?void 0:r.totalCells)||e.totalCells||0,"\n"),n+="   - Complexity: ".concat(e.formulaComplexity||"Low","\n"),n+="   - Hard-coded Values: ".concat((null===(o=e.hardCodedValueAnalysis)||void 0===o?void 0:o.totalHardCodedValues)||0,"\n"),e.uniqueFormulasList&&e.uniqueFormulasList.length>0&&(n+="   - Sample Formulas:\n",e.uniqueFormulasList.slice(0,5).forEach(function(e,t){var r=e.formula.trim();n+="     ".concat(t+1,". ").concat(r.substring(0,100)).concat(r.length>100?"...":"","\n")}),e.uniqueFormulasList.length>5&&(n+="     ... and ".concat(e.uniqueFormulasList.length-5," more\n"))),n+="\n"}),n.trim()}function kn(){return(kn=ye(le().m(function e(n){var t,r,o,a,i,s,l,c,u,d;return le().w(function(e){for(;;)switch(e.n){case 0:if((t=an())&&t.isValidated){e.n=1;break}return We("Please configure GPT settings first.","warning"),ln(),e.a(2);case 1:if(r=document.getElementById("gptResponseModal"),o=document.getElementById("gptResponseContent"),a=document.getElementById("gptResponseError"),r&&o&&a){e.n=2;break}return e.a(2);case 2:return(i=r.querySelector(".modal-header h3"))&&(i.textContent="Sheet Explanation: ".concat(n.name)),r.style.display="flex",o.textContent="Analyzing sheet and getting explanation...",a.style.display="none",s=function(e){e.target===r&&(r.style.display="none",r.removeEventListener("click",s))},r.addEventListener("click",s),e.p=3,e.n=4,vn(n);case 4:return l=e.v,e.n=5,An(t.bearerToken,t.engagementCode,l,"Explain what this Excel worksheet does based on its structure, formulas, and data. Worksheet: ".concat(n.name));case 5:(c=e.v).error?(a.textContent=c.error,a.style.display="block",o.textContent=""):(u=Cn(c))&&u.trim()?(o.innerHTML=bn(u.trim()),a.style.display="none"):(a.textContent="Could not extract explanation from response. Please check the browser console for details.",a.style.display="block",o.textContent="",console.error("Could not extract explanation from response:",c)),e.n=7;break;case 6:e.p=6,d=e.v,a.textContent="Error: ".concat(d.message||"Failed to get explanation"),a.style.display="block",o.textContent="";case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function En(){return(En=ye(le().m(function e(n){var t,r,o,a,i,s,l,c,u,d;return le().w(function(e){for(;;)switch(e.n){case 0:if((t=an())&&t.isValidated){e.n=1;break}return We("Please configure GPT settings first.","warning"),ln(),e.a(2);case 1:if(r=document.getElementById("gptResponseModal"),o=document.getElementById("gptResponseContent"),a=document.getElementById("gptResponseError"),r&&o&&a){e.n=2;break}return e.a(2);case 2:return(i=r.querySelector(".modal-header h3"))&&(i.textContent="Workbook Explanation"),r.style.display="flex",o.textContent="Analyzing workbook and getting explanation...",a.style.display="none",s=function(e){e.target===r&&(r.style.display="none",r.removeEventListener("click",s))},r.addEventListener("click",s),e.p=3,l=wn(n),e.n=4,An(t.bearerToken,t.engagementCode,l,"Explain what this Excel workbook does at a high level based on its structure, worksheets, formulas, and data. Provide an overview of the purpose and functionality of the workbook.");case 4:(c=e.v).error?(a.textContent=c.error,a.style.display="block",o.textContent=""):(u=Cn(c))&&u.trim()?(o.innerHTML=bn(u.trim()),a.style.display="none"):(a.textContent="Could not extract explanation from response. Please check the browser console for details.",a.style.display="block",o.textContent="",console.error("Could not extract explanation from response:",c)),e.n=6;break;case 5:e.p=5,d=e.v,a.textContent="Error: ".concat(d.message||"Failed to get explanation"),a.style.display="block",o.textContent="";case 6:return e.a(2)}},e,null,[[3,5]])}))).apply(this,arguments)}function Cn(e){var n="";if(e.choices&&Array.isArray(e.choices)&&e.choices.length>0){var t=e.choices[0];t.message&&"string"==typeof t.message?n=t.message:t.message&&t.message.content?n=t.message.content:t.text?n=t.text:t.content&&(n=t.content)}if(n||(e.response?n="string"==typeof e.response?e.response:JSON.stringify(e.response):e.data&&(n="string"==typeof e.data?e.data:JSON.stringify(e.data))),n||(e.text?n=e.text:e.content?n=e.content:e.message?n=e.message:e.result?n="string"==typeof e.result?e.result:JSON.stringify(e.result):e.output&&(n="string"==typeof e.output?e.output:JSON.stringify(e.output))),n||"string"!=typeof e||(n=e),!n&&e.message){var r=e.message;"string"==typeof r?n=r:r.content?n=r.content:r.text&&(n=r.text)}if(n&&n.trim()){var o=n.trim();try{var a=JSON.parse(o);"string"==typeof a?o=a:(a.text||a.content||a.message)&&(o=a.text||a.content||a.message)}catch(e){}return o}return""}function An(e,n,t,r){return Sn.apply(this,arguments)}function Sn(){return(Sn=ye(le().m(function e(n,t,r,o){var a,i,s,l,c,u,d,p,f,m,h,g,y;return le().w(function(e){for(;;)switch(e.n){case 0:return a=n.trim(),i=t.trim(),s=r.trim(),l=o.trim(),c=s.substring(0,2e4),u="".concat(l,"\n\nContext:\n").concat(c).trim(),"Bearer ".concat(a),d={engagementCode:i,modelName:"GPT 4o Omni",provider:"AzureOpenAI",providerModelName:"gpt-4o",parameters:{max_tokens:2048,frequency_penalty:2,presence_penalty:2,temperature:.7,top_p:1},prompt:u,messages:[{role:"system",content:"You are a helpful assistant that explains Excel workbooks and worksheets in plain English. Provide clear, concise explanations that help reviewers understand the purpose and functionality of the workbook or worksheet."},{role:"user",content:u}]},e.p=1,p=de(de({},d),{},{bearerToken:a}),f={"Content-Type":"application/json"},e.n=2,fetch("http://localhost:3001/api/gpt",{method:"POST",headers:f,body:JSON.stringify(p),mode:"cors",credentials:"omit"});case 2:if(401!==(m=e.v).status){e.n=3;break}return e.a(2,{error:"Authentication failed. Please check your bearer token."});case 3:if(m.ok){e.n=5;break}return e.n=4,m.text().catch(function(){return""});case 4:return h=e.v,e.a(2,{error:"Request failed with status ".concat(m.status,". ").concat(h?"Response: ".concat(h.substring(0,200)):"")});case 5:return e.n=6,m.json();case 6:return g=e.v,console.log("GPT API Response:",JSON.stringify(g,null,2)),e.a(2,g);case 7:if(e.p=7,y=e.v,console.error("GPT API error:",y),"TypeError"!==y.name||!y.message.includes("Failed to fetch")){e.n=8;break}return e.a(2,{error:"Failed to connect to GPT API. This is likely a CORS (Cross-Origin Resource Sharing) issue. The API server needs to allow requests from this Excel Add-in domain. Please contact IT support to: 1) Configure CORS headers on the API to allow requests from your add-in domain, or 2) Set up a proxy service to handle the API calls. Check the browser console (F12) for more details."});case 8:return e.a(2,{error:y.message||"Failed to connect to GPT API"})}},e,null,[[1,7]])}))).apply(this,arguments)}function Tn(){return Tn=ye(le().m(function e(n,t){var r;return le().w(function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}return We("No cell address available for this formula.","warning"),e.a(2);case 1:return e.p=1,e.n=2,Excel.run(function(){var e=ye(le().m(function e(r){return le().w(function(e){for(;;)switch(e.n){case 0:return r.workbook.worksheets.getItem(n).getRange(t).select(),e.n=1,r.sync();case 1:We("Navigated to ".concat(n,"!").concat(t),"success");case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 2:e.n=4;break;case 3:e.p=3,r=e.v,console.error("Error navigating to cell:",r),We("Failed to navigate to cell: ".concat(Ge(r)),"error");case 4:return e.a(2)}},e,null,[[1,3]])})),Tn.apply(this,arguments)}function In(e){ke.forEach(function(n){var t=document.getElementById(n),r=document.querySelector('[data-target="'.concat(n,'"]'));if(t&&r){var o=n===e;t.toggleAttribute("hidden",!o),r.setAttribute("aria-selected",o?"true":"false")}}),document.querySelectorAll("[data-view]").forEach(function(n){if(n instanceof HTMLElement){var t=n.getAttribute("data-view");t&&(t.split(",").map(function(e){return e.trim()}).includes(e)?(n.removeAttribute("hidden"),n.style.display=""):(n.setAttribute("hidden",""),n.style.display="none"))}})}function Fn(){var e=document.getElementById("minutesPerFormula");if(e){var n=Number(e.value);!Number.isFinite(n)||n<=0?e.value=String(xe):(xe=n,be&&Qe(de(de({},be),{},{uniqueSummary:{ufCount:be.uniqueSummary.ufCount,estimatedMinutes:be.uniqueSummary.ufCount*xe,minutesPerFormula:xe}})))}}function Rn(){var e=document.getElementById("analysisScope"),n=document.getElementById("sheetScopePicker");e&&n&&("sheet"===e.value?(n.hidden=!1,function(){Ln.apply(this,arguments)}()):(n.hidden=!0,Ee=[]))}function Ln(){return Ln=ye(le().m(function e(){var n,t;return le().w(function(e){for(;;)switch(e.n){case 0:if(n=document.getElementById("sheetScopeList")){e.n=1;break}return e.a(2);case 1:return n.innerHTML='<div class="sheet-scope-placeholder">Loading worksheets...</div>',e.p=2,e.n=3,Excel.run(function(){var e=ye(le().m(function e(t){var r,o,a;return le().w(function(e){for(;;)switch(e.n){case 0:return(r=t.workbook.worksheets).load("items/name"),e.n=1,t.sync();case 1:o=r.items.filter(function(e){return!e.name.endsWith("_maps")&&"kCERT_Analysis_Report"!==e.name}),a=document.createDocumentFragment(),Ee=Ee.filter(function(e){return o.some(function(n){return n.name===e})}),o.forEach(function(e){var n=document.createElement("label");n.className="sheet-scope-item";var t=document.createElement("input");t.type="checkbox",t.value=e.name,t.checked=Ee.includes(e.name),t.addEventListener("change",function(){t.checked?Ee.includes(e.name)||Ee.push(e.name):Ee=Ee.filter(function(n){return n!==e.name})});var r=document.createElement("span");r.textContent=e.name,n.append(t,r),a.appendChild(n)}),n.innerHTML="",n.appendChild(a);case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 3:e.n=5;break;case 4:e.p=4,t=e.v,console.error("Failed to populate scope picker",t),n.innerHTML='<div class="sheet-scope-placeholder">Unable to load worksheets.</div>';case 5:return e.a(2)}},e,null,[[2,4]])})),Ln.apply(this,arguments)}function On(){return Nn.apply(this,arguments)}function Nn(){return Nn=ye(le().m(function e(){var n;return le().w(function(e){for(;;)switch(e.n){case 0:if(be){e.n=1;break}return We("No analysis results to export. Please run analysis first.","warning"),e.a(2);case 1:return e.p=1,e.n=2,Excel.run(function(){var e=ye(le().m(function e(n){var t,r,o,a,i,s,l,c,u;return le().w(function(e){for(;;)switch(e.n){case 0:return t="kCERT_UFL",(r=n.workbook.worksheets.getItemOrNullObject(t)).load("isNullObject"),e.n=1,n.sync();case 1:if(r.isNullObject){e.n=2;break}return r.delete(),e.n=2,n.sync();case 2:return o=n.workbook.worksheets.add(t),a=1,o.getRange("A".concat(a)).values=[["Unique Formula Listing"]],o.getRange("A".concat(a)).format.font.bold=!0,i=[["UFI","FIN","Sheet","Formula","Formula (normalized)","Count","F-Score","Complexity","Priority","Status","Comment","Client Response"]],s=a+=2,l=document.getElementById("uniqueFormulaTableBody"),c=new Map,l?l.querySelectorAll('tr[data-row-type="ufi"], tr[data-row-type="fin"]').forEach(function(e){var n=e.querySelectorAll("td");if(n.length>=13){var t=e.getAttribute("data-row-type"),r="";if("ufi"===t){var o=n[0].querySelector("span");r=o?o.textContent||"":e.getAttribute("data-ufi")||""}else"fin"===t&&(r=e.getAttribute("data-ufi")||"");var a="fin"===t&&n[1].textContent||"",i="ufi"===t&&n[2].textContent||"";if(!i&&"fin"===t){var s=l.querySelector('tr[data-row-type="ufi"][data-ufi="'.concat(r,'"]'));if(s){var u=s.querySelectorAll("td");u.length>=3&&(i=u[2].textContent||"")}}var d="ufi"===t&&n[3].textContent||"",p="ufi"===t&&n[4].textContent||"",f="ufi"===t&&n[5].textContent||"",m="ufi"===t?n[6]:null,h="",g="";if(m){var y=m.querySelector(".complexity-label"),b=m.querySelector(".fscore-label");h=y&&y.textContent||"",g=b&&b.textContent.replace("F-Score: ","")||""}var v=n[7].querySelector("select"),x=v?v.value:n[7].textContent||"",w=n[8].textContent||"",k=n[9].textContent||"",E=n[10].textContent||"";i&&(c.has(i)||c.set(i,[]),c.get(i).push({ufi:r,fin:a,sheetName:i,formula:d,normalized:p,count:f,fScore:g,complexity:h,priority:x,status:w,comment:k,clientResponse:E,isFin:"fin"===t}))}}):be.worksheets.forEach(function(e){e.uniqueFormulasList.forEach(function(n){c.has(e.name)||c.set(e.name,[]),c.get(e.name).push({ufi:n.ufIndicator,fin:"",sheetName:e.name,formula:n.exampleFormula,normalized:n.normalizedFormula,count:String(n.count),fScore:String(n.fScore),complexity:n.complexity,priority:"",status:"",comment:"",clientResponse:"",isFin:!1})})}),Array.from(c.keys()).sort().forEach(function(e,n){var t=a;if(n>0){var r=o.getRange("A".concat(a,":L").concat(a));r.format.borders.getItem("EdgeTop").style="Continuous",r.format.borders.getItem("EdgeTop").weight="Medium",r.format.borders.getItem("EdgeTop").color="#8a8886",a++}var s=o.getRange("A".concat(a,":K").concat(a));s.merge(),s.values=[["Sheet: ".concat(e)]],s.format.font.bold=!0,s.format.font.size=13,s.format.fill.color="#0078d4",s.format.font.color="#ffffff",s.format.horizontalAlignment="Left",s.format.verticalAlignment="Center",s.format.borders.getItem("EdgeTop").style="Continuous",s.format.borders.getItem("EdgeTop").weight="Thick",s.format.borders.getItem("EdgeTop").color="#005a9e",s.format.borders.getItem("EdgeBottom").style="Continuous",s.format.borders.getItem("EdgeBottom").weight="Thick",s.format.borders.getItem("EdgeBottom").color="#005a9e",s.format.borders.getItem("EdgeLeft").style="Continuous",s.format.borders.getItem("EdgeLeft").weight="Thick",s.format.borders.getItem("EdgeLeft").color="#005a9e",s.format.borders.getItem("EdgeRight").style="Continuous",s.format.borders.getItem("EdgeRight").weight="Thick",s.format.borders.getItem("EdgeRight").color="#005a9e",a++;var l=o.getRange("A".concat(a,":K").concat(a));l.values=i,l.format.font.bold=!0,l.format.fill.color="#f3f2f1",l.format.borders.getItem("EdgeBottom").style="Continuous",l.format.borders.getItem("EdgeBottom").weight="Medium",l.format.borders.getItem("EdgeBottom").color="#8a8886",a++;var u=c.get(e),d=u.filter(function(e){return!e.isFin}),p=u.filter(function(e){return e.isFin}),f=new Map;if(p.forEach(function(e){f.has(e.ufi)||f.set(e.ufi,[]),f.get(e.ufi).push(e)}),d.forEach(function(e){o.getRange("A".concat(a,":K").concat(a)).values=[[e.ufi,e.fin,e.sheetName,e.formula,e.normalized,e.count,"".concat(e.complexity," / ").concat(e.fScore),e.priority,e.status,e.comment,e.clientResponse]],a++,(f.get(e.ufi)||[]).forEach(function(e){o.getRange("A".concat(a,":K").concat(a)).values=[[e.ufi,e.fin,e.sheetName,e.formula,e.normalized,e.count,"".concat(e.complexity," / ").concat(e.fScore),e.priority,e.status,e.comment,e.clientResponse]],a++})}),a>t+2){var m=o.getRange("A".concat(a-1,":K").concat(a-1));m.format.borders.getItem("EdgeBottom").style="Continuous",m.format.borders.getItem("EdgeBottom").weight="Medium",m.format.borders.getItem("EdgeBottom").color="#8a8886"}}),(u=a-1)>=s&&(o.tables.add("A".concat(s,":L").concat(u),!0).name="UFLTable"),e.n=3,n.sync();case 3:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 2:We('Unique Formula Listing exported to worksheet "kCERT_UFL".',"success"),e.n=4;break;case 3:e.p=3,n=e.v,console.error("Failed to export listing",n),We("Failed to export listing: ".concat(Ge(n)),"error");case 4:return e.a(2)}},e,null,[[1,3]])})),Nn.apply(this,arguments)}function Mn(e){return Pn.apply(this,arguments)}function Pn(){return Pn=ye(le().m(function e(n){var t,r,o,a,i,s,l,c;return le().w(function(e){for(;;)switch(e.n){case 0:return i=null!==(t=null===(r=document.getElementById("colorResetFills"))||void 0===r?void 0:r.checked)&&void 0!==t&&t,s=null!==(o=null===(a=document.getElementById("colorResetFont"))||void 0===a?void 0:a.checked)&&void 0!==o&&o,l=Ee.length?fe(Ee):void 0,e.p=1,e.n=2,Excel.run(function(){var e=ye(le().m(function e(t){var r,o,a,c,u,d,p,f;return le().w(function(e){for(;;)switch(e.n){case 0:return r=t.workbook,(o=r.worksheets).load("items/name"),e.n=1,t.sync();case 1:a=o.items.filter(function(e){return"kCERT_Analysis_Report"!==e.name&&!e.name.endsWith("_maps")&&(!l||l.includes(e.name))}),c=se(a),e.p=2,c.s();case 3:if((u=c.n()).done){e.n=10;break}return d=u.value,(p=d.getUsedRangeOrNullObject()).load(["isNullObject","address"]),e.n=4,t.sync();case 4:if(!p.isNullObject){e.n=5;break}return e.a(3,9);case 5:if(!n){e.n=7;break}return e.n=6,Bn(p,i,s);case 6:return e.a(3,9);case 7:if(!i&&!s){e.n=8;break}return e.n=8,Bn(p,i,s);case 8:return e.n=9,Vn(p);case 9:e.n=3;break;case 10:e.n=12;break;case 11:e.p=11,f=e.v,c.e(f);case 12:return e.p=12,c.f(),e.f(12);case 13:return e.n=14,t.sync();case 14:return e.a(2)}},e,null,[[2,11,12,13]])}));return function(n){return e.apply(this,arguments)}}());case 2:We(n?"Model colors removed.":"Unique and input coloring applied.","success"),e.n=4;break;case 3:e.p=3,c=e.v,console.error("Coloring failed",c),We("Coloring failed: ".concat(Ge(c)),"error");case 4:return e.a(2)}},e,null,[[1,3]])})),Pn.apply(this,arguments)}function Bn(e,n,t){return Dn.apply(this,arguments)}function Dn(){return(Dn=ye(le().m(function e(n,t,r){return le().w(function(e){for(;;)switch(e.n){case 0:t&&n.format.fill.clear(),r&&(n.format.font.color="Automatic");case 1:return e.a(2)}},e)}))).apply(this,arguments)}function Vn(e){return Hn.apply(this,arguments)}function Hn(){return(Hn=ye(le().m(function e(n){var t,r,o,a,i,s,l;return le().w(function(e){for(;;)switch(e.n){case 0:return n.load(["formulas","values"]),e.n=1,n.context.sync();case 1:for(t=n.formulas,r=n.values,o=0;o<t.length;o++)for(a=0;a<t[o].length;a++)i=t[o][a],s=r[o][a],l=n.getCell(o,a),"string"==typeof i&&i.startsWith("=")?l.format.fill.color="#7030A0":"number"==typeof s&&(l.format.fill.color="#FFC000");case 2:return e.a(2)}},e)}))).apply(this,arguments)}})()})();